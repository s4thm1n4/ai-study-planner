<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Study Planner - Dashboard</title>
    <!-- Version: 2025-10-23-15:54 - Interactive Roadmap Update -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --card-bg: #ffffff;
            --hover-bg: #f3f4f6;
        }

        body.dark-mode {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border-color: #334155;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            --card-bg: #1e293b;
            --hover-bg: #334155;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: var(--bg-primary);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Dark Mode Toggle Button */
        .dark-mode-toggle {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.2);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 9997;
        }

        .dark-mode-toggle:hover {
            transform: scale(1.1) rotate(15deg);
            box-shadow: 0 15px 35px -5px rgba(0, 0, 0, 0.3);
        }

        .dark-mode-toggle:active {
            transform: scale(0.95) rotate(0deg);
        }

        body.dark-mode .dark-mode-toggle {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        /* Navigation */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            z-index: 1000;
            padding: 1rem 0;
        }

        body.dark-mode .navbar {
            background: rgba(30, 41, 59, 0.95);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: #6366f1;
            text-decoration: none;
        }

        .logo i {
            margin-right: 0.5rem;
            font-size: 1.8rem;
        }

        .user-nav {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(99, 102, 241, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            color: #6366f1;
            font-weight: 500;
        }

        .user-info i {
            color: #10b981;
        }

        .nav-links {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .nav-link {
            color: #6b7280;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-link:hover {
            color: #6366f1;
        }

        .nav-new-plan-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%) !important;
            color: white !important;
            padding: 0.625rem 1.25rem !important;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .nav-new-plan-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
            color: white !important;
        }

        .logout-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: #dc2626;
            transform: translateY(-1px);
        }

        /* Main Content */
        .main-content {
            margin-top: 6rem;
            padding: 2rem 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .welcome-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3rem 2rem;
            border-radius: 1.5rem;
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
        }

        .welcome-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="%23ffffff" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="%23ffffff" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
        }

        .welcome-content {
            position: relative;
            z-index: 1;
        }

        .welcome-section h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .welcome-section p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Tabs */
        .tabs-container {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .tabs {
            display: flex;
            background: #f8fafc;
            border-bottom: 1px solid #e5e7eb;
        }

        .tab {
            flex: 1;
            padding: 1.5rem 2rem;
            text-align: center;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: #6b7280;
            transition: all 0.3s ease;
            position: relative;
        }

        .tab.active {
            background: white;
            color: #6366f1;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .tab:hover:not(.active) {
            background: #f1f5f9;
            color: #4b5563;
        }

        .tab i {
            margin-right: 0.5rem;
            font-size: 1.1rem;
        }

        /* Tab Content */
        .tab-content {
            display: none;
            padding: 3rem;
        }

        .tab-content.active {
            display: block;
        }

        .tab-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .tab-header h2 {
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }

        .tab-header p {
            font-size: 1.1rem;
            color: #6b7280;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .input-group {
            margin-bottom: 1rem;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #374151;
            font-size: 0.9rem;
        }

        .input-group label i {
            color: #6366f1;
            margin-right: 0.5rem;
        }

        .input-group select,
        .input-group input {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            font-size: 1rem;
            background: white;
            transition: all 0.3s ease;
        }

        .input-group select:focus,
        .input-group input:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .input-help {
            display: block;
            margin-top: 0.25rem;
            font-size: 0.875rem;
            color: #6b7280;
            font-style: italic;
        }

        .generate-btn {
            width: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 0.5rem;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .generate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Mood Selector Styles */
        .mood-selector {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
        }

        .mood-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 0.75rem 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 70px;
            text-align: center;
        }

        .mood-btn:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .mood-btn.selected {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-color: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .mood-emoji {
            font-size: 1.5rem;
            animation: bounceIn 0.6s ease-out;
            transition: transform 0.2s ease;
        }

        .mood-btn:hover .mood-emoji {
            transform: scale(1.2);
            animation: pulse 1s infinite;
        }

        .mood-btn.selected .mood-emoji {
            animation: celebrate 0.8s ease-out;
        }

        .mood-label {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .mood-btn.selected .mood-label {
            color: white;
        }

        /* Mood Animations */
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes celebrate {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.2) rotate(-5deg); }
            75% { transform: scale(1.2) rotate(5deg); }
        }

        /* Progress Tracker Styles */
        .streak-counter {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            background: linear-gradient(135deg, #ff6b6b, #ff8e53);
            color: white;
            padding: 2rem;
            border-radius: 1rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 32px rgba(255, 107, 107, 0.3);
        }

        .streak-flame {
            font-size: 3rem;
            animation: flicker 1.5s infinite alternate;
        }

        .streak-info {
            text-align: center;
        }

        .streak-number {
            font-size: 3rem;
            font-weight: bold;
            line-height: 1;
        }

        .streak-label {
            font-size: 0.9rem;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .streak-message {
            font-size: 1.1rem;
            font-style: italic;
            opacity: 0.95;
        }

        @keyframes flicker {
            0%, 100% { transform: scale(1) rotate(-2deg); }
            50% { transform: scale(1.1) rotate(2deg); }
        }

        .progress-overview {
            margin-bottom: 2rem;
        }

        .progress-card {
            background: var(--bg-primary);
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            color: var(--text-primary);
        }

        .progress-container {
            margin-top: 1.5rem;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .progress-percentage {
            color: #667eea;
            font-size: 1.1rem;
        }

        .progress-bar-container {
            position: relative;
            background: #f1f5f9;
            border-radius: 1rem;
            height: 12px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 1rem;
            width: 0%;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .progress-spark {
            position: absolute;
            top: 0;
            right: -2px;
            width: 4px;
            height: 100%;
            background: white;
            border-radius: 2px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .progress-bar.animating .progress-spark {
            opacity: 0.8;
            animation: spark 0.8s ease-in-out;
        }

        @keyframes spark {
            0%, 100% { opacity: 0; transform: translateX(0); }
            50% { opacity: 1; transform: translateX(-10px); }
        }

        .daily-tracking {
            background: var(--bg-primary);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            color: var(--text-primary);
        }

        .daily-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.75rem;
            margin-bottom: 2rem;
        }

        .day-box {
            aspect-ratio: 1;
            border: 2px solid #e2e8f0;
            border-radius: 0.75rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8fafc;
            position: relative;
        }

        .day-box:hover {
            border-color: #cbd5e1;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .day-box.completed {
            background: linear-gradient(135deg, #10b981, #059669);
            border-color: #10b981;
            color: white;
            transform: scale(1.05);
        }

        .day-box.today {
            border-color: #667eea;
            border-width: 3px;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
        }

        .day-number {
            font-weight: bold;
            font-size: 0.9rem;
        }

        .day-label {
            font-size: 0.7rem;
            opacity: 0.7;
            text-transform: uppercase;
        }

        .completion-indicator {
            position: absolute;
            top: 4px;
            right: 4px;
            font-size: 0.8rem;
        }

        .day-box.completed .completion-indicator {
            animation: checkBounce 0.6s ease-out;
        }

        @keyframes checkBounce {
            0% { transform: scale(0) rotate(0deg); }
            50% { transform: scale(1.2) rotate(180deg); }
            100% { transform: scale(1) rotate(360deg); }
        }

        .quick-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .action-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .action-btn.secondary {
            background: #6b7280;
        }

        .action-btn.secondary:hover {
            box-shadow: 0 8px 25px rgba(107, 114, 128, 0.4);
        }

        .achievements-section {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .achievement {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .achievement.unlocked {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            border-color: #fbbf24;
            color: white;
            transform: scale(1.02);
            box-shadow: 0 8px 25px rgba(251, 191, 36, 0.3);
        }

        .achievement.locked {
            opacity: 0.6;
        }

        .achievement-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .achievement-name {
            font-weight: bold;
            margin-bottom: 0.25rem;
        }

        .achievement-desc {
            font-size: 0.85rem;
            opacity: 0.8;
        }

        .celebration-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .celebration-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .confetti {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .celebration-message {
            background: white;
            padding: 3rem;
            border-radius: 2rem;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .celebration-overlay.show .celebration-message {
            transform: scale(1);
        }

        .celebration-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            animation: celebrationBounce 1s ease-in-out infinite;
        }

        .celebration-text {
            font-size: 2rem;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }

        .celebration-subtext {
            font-size: 1.2rem;
            color: #6b7280;
        }

        @keyframes celebrationBounce {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-20px) scale(1.1); }
        }

        @keyframes confettiBurst {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(var(--vx), var(--vy)) scale(0);
                opacity: 0;
            }
        }

        /* Results Section */
        .results {
            margin-top: 2rem;
            padding: 0;
            background: transparent;
        }

        .results-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 1rem 1rem 0 0;
            text-align: center;
            position: relative;
            overflow: hidden;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
            min-height: 100px;
        }

        .results-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="%23ffffff" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/>') repeat;
            opacity: 0.3;
        }

        .results-header h3 {
            font-size: 2rem;
            font-weight: 800;
            margin: 0;
            position: relative;
            z-index: 1;
            flex: 1;
            text-align: center;
        }

        .new-plan-btn {
            background: white;
            border: none;
            color: #6366f1;
            padding: 0.875rem 1.75rem;
            border-radius: 0.75rem;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            z-index: 10;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            white-space: nowrap;
        }

        .new-plan-btn:hover {
            background: #f8fafc;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .new-plan-btn:active {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .new-plan-btn svg {
            transition: transform 0.3s ease;
        }

        .new-plan-btn:hover svg {
            transform: rotate(90deg);
        }

        .results-content {
            background: var(--bg-primary);
            border-radius: 0 0 1rem 1rem;
            padding: 2rem;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .plan-overview {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-bottom: 2.5rem;
            padding: 0;
            background: transparent;
            border-radius: 0;
            border: none;
        }

        .plan-stat {
            position: relative;
            text-align: left;
            padding: 1.5rem 1.25rem;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 1rem;
            border: 2px solid #e2e8f0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.08), 0 2px 4px -1px rgba(0, 0, 0, 0.04);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        .plan-stat::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, #6366f1 0%, #8b5cf6 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .plan-stat:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px -4px rgba(99, 102, 241, 0.2), 0 8px 16px -4px rgba(99, 102, 241, 0.1);
            border-color: #c7d2fe;
        }

        .plan-stat:hover::before {
            opacity: 1;
        }

        .plan-stat-label {
            font-size: 0.75rem;
            color: #64748b;
            font-weight: 600;
            text-transform: capitalize;
            letter-spacing: 0.5px;
            margin-bottom: 0.6rem;
            display: block;
        }

        .plan-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0;
            line-height: 1.2;
            word-break: break-word;
        }

        /* Remove special styling for first stat since all are equal now */

        body.dark-mode .plan-stat {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border-color: #334155;
        }

        body.dark-mode .plan-stat-value {
            color: #f1f5f9;
        }

        body.dark-mode .plan-stat-label {
            color: #94a3b8;
        }

        body.dark-mode .plan-stat:hover {
            border-color: #4c1d95;
            box-shadow: 0 12px 24px -4px rgba(139, 92, 246, 0.3), 0 8px 16px -4px rgba(139, 92, 246, 0.2);
        }

        /* ===== ROADMAP SCHEDULE STYLES ===== */
        .schedule-roadmap-container {
            position: relative;
            padding: 3rem 0;
            background: linear-gradient(135deg, #f8fafc 0%, #e0e7ff 100%);
            border-radius: 2rem;
            margin: 2rem 0;
        }

        body.dark-mode .schedule-roadmap-container {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }

        .schedule-roadmap {
            position: relative;
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }

        .roadmap-path {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, 
                #10b981 0%, 
                #3b82f6 25%, 
                #8b5cf6 50%, 
                #ec4899 75%, 
                #f59e0b 100%
            );
            opacity: 0.3;
            z-index: 0;
        }

        .roadmap-node {
            position: relative;
            display: flex;
            align-items: center;
            margin-bottom: 4rem;
            opacity: 0;
            animation: fadeInUp 0.6s ease forwards;
            z-index: 1;
        }

        .roadmap-node:nth-child(odd) {
            justify-content: flex-start;
        }

        .roadmap-node:nth-child(even) {
            justify-content: flex-end;
        }

        .roadmap-node:nth-child(1) { animation-delay: 0.1s; }
        .roadmap-node:nth-child(2) { animation-delay: 0.2s; }
        .roadmap-node:nth-child(3) { animation-delay: 0.3s; }
        .roadmap-node:nth-child(4) { animation-delay: 0.4s; }
        .roadmap-node:nth-child(5) { animation-delay: 0.5s; }
        .roadmap-node:nth-child(6) { animation-delay: 0.6s; }
        .roadmap-node:nth-child(7) { animation-delay: 0.7s; }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .roadmap-marker {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ffffff 0%, #f3f4f6 100%);
            border: 5px solid #10b981;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.5rem;
            color: #10b981;
            z-index: 3;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 30px -5px rgba(16, 185, 129, 0.4), 0 0 0 0 rgba(16, 185, 129, 0.4);
            cursor: pointer;
        }

        .roadmap-marker:hover {
            transform: translateX(-50%) scale(1.15) rotate(10deg);
            box-shadow: 0 20px 40px -5px rgba(16, 185, 129, 0.6);
        }

        .roadmap-node.completed .roadmap-marker {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border-color: #059669;
            animation: pulse 2s infinite, float 3s ease-in-out infinite;
        }

        .roadmap-node.in-progress .roadmap-marker {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            border-color: #f59e0b;
            color: white;
            animation: pulse 1.5s infinite, float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-10px); }
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
            }
            50% {
                box-shadow: 0 0 0 10px rgba(16, 185, 129, 0);
            }
        }

        .roadmap-card {
            background: white;
            border-radius: 1.5rem;
            padding: 2rem;
            border: 2px solid #e5e7eb;
            box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            width: 420px;
            max-width: 45%;
            cursor: pointer;
        }

        body.dark-mode .roadmap-card {
            background: var(--card-bg);
            border-color: var(--border-color);
        }

        .roadmap-node:nth-child(odd) .roadmap-card {
            margin-right: 120px;
        }

        .roadmap-node:nth-child(even) .roadmap-card {
            margin-left: 120px;
        }

        .roadmap-card:hover {
            transform: scale(1.05);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            border-color: #2563eb;
        }

        .roadmap-node.completed .roadmap-card {
            border-color: #10b981;
            background: linear-gradient(135deg, #f0fdf4 0%, white 50%);
        }

        body.dark-mode .roadmap-node.completed .roadmap-card {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, var(--card-bg) 50%);
        }

        .roadmap-node.in-progress .roadmap-card {
            border-color: #f59e0b;
            background: linear-gradient(135deg, #fffbeb 0%, white 50%);
        }

        body.dark-mode .roadmap-node.in-progress .roadmap-card {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, var(--card-bg) 50%);
        }
        
        .resource-view-prompt {
            text-align: center;
            margin-top: 1.25rem;
            padding-top: 1.25rem;
            border-top: 1px dashed var(--border-color);
        }
        
        .view-resources-btn {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            border: none;
            border-radius: 0.75rem;
            padding: 0.875rem 1.75rem;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3);
        }

        .view-resources-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -5px rgba(59, 130, 246, 0.5);
            background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
        }

        .view-resources-btn:active {
            transform: translateY(0);
        }
        
        .view-resources-button {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            border-radius: 1.5rem;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            margin: 1rem auto 0.5rem;
            cursor: pointer;
            position: relative;
            width: fit-content;
            transition: all 0.3s ease;
            animation: pulse 2s infinite;
        }

        .view-resources-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px -5px rgba(59, 130, 246, 0.4);
        }

        .button-pulse {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            background: inherit;
            border-radius: inherit;
            z-index: -1;
            transform: translate(-50%, -50%);
            opacity: 0;
            animation: pulse-glow 2s infinite;
        }

        @keyframes pulse-glow {
            0% {
                transform: translate(-50%, -50%) scale(0.8);
                opacity: 0.7;
            }
            70% {
                transform: translate(-50%, -50%) scale(1.5);
                opacity: 0;
            }
            100% {
                opacity: 0;
            }
        }

        body.dark-mode .view-resources-button {
            background: linear-gradient(135deg, #4f46e5 0%, #3730a3 100%);
        }

        .timeline-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .timeline-day-info h4 {
            color: #1f2937;
            font-weight: 700;
            font-size: 1.125rem;
            margin: 0 0 0.25rem 0;
        }

        .timeline-date {
            color: #6b7280;
            font-size: 0.875rem;
        }

        .timeline-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-badge {
            padding: 0.375rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-badge.completed {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            color: #065f46;
            border: 1px solid #6ee7b7;
        }

        .status-badge.in-progress {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            color: #92400e;
            border: 1px solid #fbbf24;
        }

        .status-badge.not-started {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            color: #4b5563;
            border: 1px solid #d1d5db;
        }

        .timeline-checkbox {
            width: 22px;
            height: 22px;
            cursor: pointer;
            accent-color: #10b981;
        }

        .timeline-topics {
            margin-bottom: 1rem;
        }

        .timeline-topics h5 {
            color: #6b7280;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 0 0 0.5rem 0;
            font-weight: 600;
        }

        .topic-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .topic-tag {
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
            background: linear-gradient(135deg, #ddd6fe 0%, #c4b5fd 100%);
            color: #5b21b6;
            padding: 0.375rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            border: 1px solid #c4b5fd;
        }

        .timeline-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #f3f4f6;
        }

        .timeline-duration {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #3b82f6;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .timeline-progress {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex: 1;
            margin-left: 1rem;
        }

        .progress-bar {
            flex: 1;
            height: 8px;
            background: #e5e7eb;
            border-radius: 1rem;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #3b82f6 100%);
            border-radius: 1rem;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            font-size: 0.75rem;
            font-weight: 700;
            color: #6b7280;
            min-width: 40px;
            text-align: right;
        }

        .difficulty-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .difficulty-easy {
            background: #d1fae5;
            color: #065f46;
        }

        .difficulty-medium {
            background: #fef3c7;
            color: #92400e;
        }

        .difficulty-hard {
            background: #fecaca;
            color: #991b1b;
        }

        /* ===== ROADMAP RESOURCE POPUP FLASHCARD ===== */
        .resource-popup-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            z-index: 10001;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            animation: fadeIn 0.3s ease;
        }

        .resource-popup-overlay.active {
            display: flex;
        }

        /* Side Panel for Resources */
        .resource-side-panel {
            position: fixed;
            right: -450px;
            top: 0;
            bottom: 0;
            width: 450px;
            background: var(--bg-primary);
            box-shadow: -4px 0 24px rgba(0, 0, 0, 0.15);
            z-index: 10002;
            display: flex;
            flex-direction: column;
            transition: right 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .resource-side-panel.open {
            right: 0;
        }

        /* Backdrop overlay for side panel */
        .resource-panel-backdrop {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 10001;
            animation: fadeIn 0.3s ease;
            cursor: pointer;
        }

        .resource-panel-backdrop.active {
            display: block;
        }

        .side-panel-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--text-primary);
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: start;
            flex-shrink: 0;
        }

        .side-panel-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 0.5rem;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            color: white;
            position: relative;
        }

        .side-panel-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .side-panel-close:active {
            transform: scale(0.95);
        }

        /* Make close button more prominent on mobile */
        @media (max-width: 640px) {
            .side-panel-close {
                width: 44px;
                height: 44px;
                background: rgba(255, 255, 255, 0.3);
                border: 2px solid rgba(255, 255, 255, 0.5);
            }
        }

        .side-panel-body {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
            background: var(--bg-primary);
        }

        .side-panel-resources-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            color: var(--text-primary);
        }

        .side-panel-resource-item {
            background: var(--bg-primary);
            border: 1px solid #e5e7eb;
            border-radius: 1rem;
            padding: 1.25rem;
            transition: all 0.2s;
            animation: slideInFromRight 0.3s ease-out both;
            color: var(--text-primary) ;
        }

        .side-panel-resource-item:hover {
            background: white;
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
            transform: translateX(-4px);
        }

        .resource-icon-large {
            font-size: 2rem;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 0.75rem;
            flex-shrink: 0;
        }

        .resource-badge {
            display: inline-block;
            padding: 0.25rem 0.625rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: capitalize;
        }

        .resource-link-btn {
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 600;
            transition: all 0.2s;
        }

        .resource-link-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        @keyframes slideInFromRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @media (max-width: 768px) {
            .resource-side-panel {
                width: 100%;
                right: -100%;
            }
            
            .resource-side-panel.open {
                right: 0;
            }
        }

        /* Mobile: Convert to centered modal on very small screens */
        @media (max-width: 640px) {
            .resource-side-panel {
                right: auto;
                left: 50%;
                top: 50%;
                bottom: auto;
                transform: translate(-50%, -50%) scale(0.9);
                width: calc(100% - 2rem);
                max-width: 480px;
                max-height: 85vh;
                border-radius: 1.5rem;
                opacity: 0;
                pointer-events: none;
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }

            .resource-side-panel.open {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
                pointer-events: auto;
            }
        }

        .resource-flashcard {
            background: white;
            border-radius: 2rem;
            max-width: 700px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            animation: slideUpBounce 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        body.dark-mode .resource-flashcard {
            background: var(--card-bg);
        }

        @keyframes slideUpBounce {
            from {
                opacity: 0;
                transform: translateY(100px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .flashcard-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 2rem;
            border-radius: 2rem 2rem 0 0;
            color: white;
            position: relative;
        }

        .flashcard-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .flashcard-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .flashcard-title {
            margin: 0 0 0.5rem 0;
            font-size: 1.75rem;
            font-weight: 700;
        }

        .flashcard-subtitle {
            margin: 0;
            opacity: 0.9;
            font-size: 0.95rem;
        }

        .flashcard-body {
            padding: 2rem;
        }

        .resource-item-flashcard {
            background: var(--bg-primary);
            border-radius: 1rem;
            padding: 1rem 1.5rem;
            margin-bottom: 1rem;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
            display: block;
            text-decoration: none;
        }

        body.dark-mode .resource-item-flashcard {
            background: var(--card-bg);
        }

        .resource-item-flashcard:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: var(--shadow);
            border-color: #2563eb;
        }

        .resource-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .resource-item-icon {
            width: 40px;
            height: 40px;
            border-radius: 0.75rem;
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            color: #1e40af;
        }

        .resource-item-info {
            flex: 1;
        }

        .resource-item-title {
            font-weight: 600;
            font-size: 1rem;
            color: var(--text-primary);
            margin: 0 0 0.25rem 0;
        }

        .resource-item-desc {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin: 0;
        }

        .resource-action-btn {
            font-size: 1.25rem;
            color: #9ca3af;
            transition: all 0.3s ease;
        }

        .resource-item-flashcard:hover .resource-action-btn {
            color: #2563eb;
            transform: translateX(5px);
        }

        .resource-type-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* ===== RESOURCE HUB CARD GRID STYLES ===== */
        .resource-hub-container {
            margin: 2rem 0;
        }

        .resource-filters {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid #e5e7eb;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .filter-section {
            margin-bottom: 1.5rem;
        }

        .filter-section:last-child {
            margin-bottom: 0;
        }

        .filter-label {
            display: block;
            color: #6b7280;
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.75rem;
        }

        .filter-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            border-radius: 0.75rem;
            border: 2px solid #e5e7eb;
            background: white;
            color: #6b7280;
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-btn:hover {
            border-color: #2563eb;
            color: #2563eb;
            transform: translateY(-1px);
        }

        .filter-btn.active {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            border-color: #1d4ed8;
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .search-bar {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 3rem;
            border-radius: 0.75rem;
            border: 2px solid #e5e7eb;
            font-size: 1rem;
            transition: all 0.2s ease;
            background: white url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="%236b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>') no-repeat 1rem center;
        }

        .search-bar:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .resource-card-modern {
            background: white;
            border-radius: 1rem;
            overflow: hidden;
            border: 1px solid #e5e7eb;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
        }

        .resource-card-modern:hover {
            transform: translateY(-6px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.15), 0 10px 10px -5px rgba(0, 0, 0, 0.08);
        }

        .resource-thumbnail {
            width: 100%;
            height: 180px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            position: relative;
            overflow: hidden;
        }

        .resource-thumbnail::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: shimmer 3s infinite;
        }

        .resource-thumbnail.video {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .resource-thumbnail.article {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .resource-thumbnail.book {
            background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
        }

        .resource-thumbnail.course {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
        }

        .resource-card-body {
            padding: 1.25rem;
        }

        .resource-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .resource-type-badge {
            padding: 0.25rem 0.625rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .resource-type-badge.video {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            color: #92400e;
        }

        .resource-type-badge.article {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            color: #065f46;
        }

        .resource-type-badge.book {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            color: #1e40af;
        }

        .resource-type-badge.course {
            background: linear-gradient(135deg, #e9d5ff 0%, #d8b4fe 100%);
            color: #6b21a8;
        }

        .resource-favorite {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            background: #f3f4f6;
            color: #9ca3af;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .resource-favorite:hover {
            background: #fee2e2;
            color: #dc2626;
            transform: scale(1.1);
        }

        .resource-favorite.active {
            background: linear-gradient(135deg, #fecaca 0%, #fca5a5 100%);
            color: #dc2626;
        }

        .resource-card-title {
            color: #1f2937;
            font-weight: 700;
            font-size: 1.125rem;
            margin: 0 0 0.5rem 0;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .resource-card-description {
            color: #6b7280;
            font-size: 0.875rem;
            line-height: 1.6;
            margin-bottom: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .resource-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .stars {
            display: flex;
            gap: 0.125rem;
            color: #f59e0b;
            font-size: 1rem;
        }

        .rating-count {
            color: #9ca3af;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .resource-card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 1px solid #f3f4f6;
        }

        .resource-duration {
            display: flex;
            align-items: center;
            gap: 0.375rem;
            color: #6b7280;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .resource-view-btn {
            padding: 0.5rem 1rem;
            border-radius: 0.625rem;
            border: none;
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .resource-view-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(37, 99, 235, 0.4);
        }

        .premium-lock {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            color: #fbbf24;
            padding: 0.375rem 0.75rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.375rem;
            z-index: 1;
        }

        .no-resources {
            text-align: center;
            padding: 3rem 1rem;
            color: #9ca3af;
        }

        .no-resources-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .no-resources-text {
            font-size: 1.125rem;
            font-weight: 600;
            color: #6b7280;
        }

        /* ===== PROGRESS TRACKING DASHBOARD STYLES ===== */
        .progress-dashboard {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 1.5rem;
            padding: 2rem;
            margin: 2rem 0;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .progress-dashboard::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            border-radius: 50%;
        }

        .progress-header {
            text-align: center;
            margin-bottom: 2rem;
            position: relative;
            z-index: 1;
        }

        .progress-header h4 {
            margin: 0 0 0.5rem 0;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .progress-header p {
            margin: 0;
            opacity: 0.9;
            font-size: 0.875rem;
        }

        .progress-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
            position: relative;
            z-index: 1;
        }

        .progress-stat-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .progress-stat-card:hover {
            transform: translateY(-4px);
            background: rgba(255, 255, 255, 0.25);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
            display: block;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin: 0;
            line-height: 1;
        }

        .stat-label {
            font-size: 0.875rem;
            margin: 0.5rem 0 0 0;
            opacity: 0.9;
        }

        .streak-counter {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .streak-flame {
            animation: flicker 1.5s infinite;
        }

        @keyframes flicker {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .achievements-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 1.5rem;
            position: relative;
            z-index: 1;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .achievements-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .achievements-header h5 {
            margin: 0;
            font-size: 1.125rem;
            font-weight: 700;
        }

        .view-all-link {
            color: white;
            text-decoration: none;
            font-size: 0.875rem;
            opacity: 0.9;
            transition: opacity 0.2s ease;
        }

        .view-all-link:hover {
            opacity: 1;
            text-decoration: underline;
        }

        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 1rem;
        }

        .achievement-badge {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(5px);
            border-radius: 0.75rem;
            padding: 1rem;
            text-align: center;
            transition: all 0.2s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .achievement-badge:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.5);
            transform: scale(1.05);
        }

        .achievement-badge.locked {
            opacity: 0.5;
            filter: grayscale(1);
        }

        .achievement-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .achievement-name {
            font-size: 0.75rem;
            font-weight: 600;
            margin: 0;
        }

        .progress-chart-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-top: 1.5rem;
            position: relative;
            z-index: 1;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .progress-chart-header {
            margin-bottom: 1rem;
        }

        .progress-chart-header h5 {
            margin: 0 0 0.25rem 0;
            font-size: 1.125rem;
            font-weight: 700;
        }

        .progress-chart-header p {
            margin: 0;
            font-size: 0.875rem;
            opacity: 0.9;
        }

        .weekly-chart {
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            gap: 0.5rem;
            height: 120px;
            position: relative;
        }

        .weekly-chart::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: rgba(255, 255, 255, 0.2);
        }

        .chart-bar {
            flex: 1;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 0.5rem 0.5rem 0 0;
            min-height: 20px;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            align-items: center;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
        }

        .chart-bar:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        .chart-bar.active {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.6) 100%);
        }

        .chart-bar-value {
            font-size: 0.75rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .chart-bar-label {
            font-size: 0.625rem;
            margin-top: 0.5rem;
            opacity: 0.9;
        }

        .resource-item {
            background: var(--bg-primary);
            border-radius: 1rem;
            padding: 1.5rem;
            border: 1px solid #e5e7eb;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .resource-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, #f59e0b 0%, #d97706 100%);
        }

        .resource-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.15), 0 10px 10px -5px rgba(0, 0, 0, 0.08);
        }

        .resource-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .resource-title {
            color: #1f2937;
            font-weight: 700;
            font-size: 1.125rem;
            margin: 0;
            line-height: 1.4;
        }

        .resource-optimized {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .resource-meta {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .resource-badge {
            background: #f3f4f6;
            color: #374151;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: capitalize;
        }

        .resource-badge.type {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            color: #1e40af;
        }

        .resource-badge.difficulty {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            color: #92400e;
        }

        .resource-description {
            color: #6b7280;
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .resource-actions {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .resource-link {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .resource-link:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
        }

        .resource-relevance {
            font-size: 0.75rem;
            color: #059669;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .motivation-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 1rem;
            margin-top: 2rem;
            position: relative;
            overflow: hidden;
        }

        .motivation-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="stars" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="0.5" fill="%23ffffff" opacity="0.3"/></pattern></defs><rect width="100" height="100" fill="url(%23stars)') repeat;
        }

        .motivation-content {
            position: relative;
            z-index: 1;
        }

        .motivation-quote {
            font-size: 1.25rem;
            font-style: italic;
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .motivation-author {
            font-weight: 600;
            margin-bottom: 1.5rem;
            opacity: 0.9;
        }

        .motivation-tip {
            background: rgba(255, 255, 255, 0.2);
            padding: 1rem;
            border-radius: 0.75rem;
            backdrop-filter: blur(10px);
        }

        .motivation-encouragement {
            background: rgba(255, 255, 255, 0.15);
            padding: 1rem;
            border-radius: 0.75rem;
            backdrop-filter: blur(10px);
            margin-bottom: 1rem;
        }

        .mood-insights {
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 0.75rem;
            backdrop-filter: blur(10px);
            margin-top: 1rem;
        }

        .mood-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: capitalize;
            margin-left: 0.5rem;
        }

        .mood-badge.mood-optimistic {
            background: rgba(34, 197, 94, 0.2);
            color: #16a34a;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .mood-badge.mood-neutral {
            background: rgba(59, 130, 246, 0.2);
            color: #2563eb;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .mood-badge.mood-anxious {
            background: rgba(245, 158, 11, 0.2);
            color: #d97706;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .mood-badge.mood-frustrated {
            background: rgba(239, 68, 68, 0.2);
            color: #dc2626;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .mood-levels {
            margin-top: 0.5rem;
            font-size: 0.875rem;
            opacity: 0.9;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid #f1f5f9;
        }

        .section-icon {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.125rem;
        }

        .section-title {
            color: #1f2937;
            font-size: 1.25rem;
            font-weight: 700;
            margin: 0;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .results-header {
                flex-direction: column;
                gap: 1rem;
                padding: 1.5rem 1rem;
            }
            
            .results-header h3 {
                font-size: 1.5rem;
                text-align: center;
            }
            
            .new-plan-btn {
                width: 100%;
                justify-content: center;
            }
            
            .plan-overview {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }
            
            .plan-stat {
                padding: 1.25rem 1rem;
            }

            .plan-stat-label {
                font-size: 0.7rem;
            }

            .plan-stat-value {
                font-size: 1.25rem;
            }
            
            .schedule-grid {
                grid-template-columns: 1fr;
            }
            
            .resources-grid {
                grid-template-columns: 1fr;
            }
            
            .results-header h3 {
                font-size: 1.5rem;
            }
            
            .schedule-item,
            .resource-item {
                padding: 1rem;
            }

            /* Roadmap Mobile Styles */
            .roadmap-path {
                left: 30px;
                transform: none;
            }

            .roadmap-node {
                justify-content: flex-start !important;
                margin-bottom: 3rem;
            }

            .roadmap-card {
                width: 100%;
                max-width: 100%;
                margin: 0 0 0 80px !important;
            }

            .roadmap-marker {
                left: 30px;
                transform: none;
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }

            .roadmap-marker:hover {
                transform: scale(1.1);
            }

            .roadmap-node.completed .roadmap-marker,
            .roadmap-node.in-progress .roadmap-marker {
                animation: pulse 2s infinite;
            }

            .timeline-header {
                flex-direction: column;
                gap: 0.75rem;
                align-items: flex-start;
            }

            .timeline-status {
                width: 100%;
                justify-content: space-between;
            }

            .timeline-footer {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.75rem;
            }

            .timeline-progress {
                width: 100%;
                margin-left: 0;
            }

            .resource-flashcard {
                max-height: 90vh;
                border-radius: 1.5rem 1.5rem 0 0;
            }

            .flashcard-header {
                padding: 1.5rem;
            }

            .flashcard-title {
                font-size: 1.25rem;
            }

            .flashcard-body {
                padding: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .plan-overview {
                grid-template-columns: 1fr;
            }
            
            .resource-meta {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .resource-actions {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }
            
            .resource-link {
                text-align: center;
            }
            
            .schedule-day {
                flex-direction: column;
                text-align: center;
                gap: 0.5rem;
            }

            .timeline-day-info h4 {
                font-size: 1rem;
            }

            .topic-list {
                flex-direction: column;
            }
        }

        /* Animation Enhancements */
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes celebration {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.05) rotate(2deg); }
            75% { transform: scale(1.05) rotate(-2deg); }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .results {
            animation: slideInUp 0.6s ease-out;
        }

        .schedule-item,
        .resource-item {
            animation: fadeIn 0.4s ease-out;
        }

        .schedule-item:nth-child(odd) {
            animation-delay: 0.1s;
        }

        .schedule-item:nth-child(even) {
            animation-delay: 0.2s;
        }

        /* ===== TOAST NOTIFICATION STYLES ===== */
        .toast-container {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            max-width: 400px;
        }

        .toast {
            background: white;
            border-radius: 0.75rem;
            padding: 1rem 1.25rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border-left: 4px solid #10b981;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            animation: slideInRight 0.3s ease-out;
            min-width: 300px;
        }

        .toast.success {
            border-left-color: #10b981;
        }

        .toast.error {
            border-left-color: #ef4444;
        }

        .toast.warning {
            border-left-color: #f59e0b;
        }

        .toast.info {
            border-left-color: #3b82f6;
        }

        .toast-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 700;
            color: #1f2937;
            margin: 0 0 0.25rem 0;
            font-size: 0.875rem;
        }

        .toast-message {
            color: #6b7280;
            margin: 0;
            font-size: 0.875rem;
            line-height: 1.4;
        }

        .toast-close {
            background: none;
            border: none;
            color: #9ca3af;
            cursor: pointer;
            font-size: 1.25rem;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.25rem;
            transition: all 0.2s ease;
        }

        .toast-close:hover {
            background: #f3f4f6;
            color: #1f2937;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideOutRight {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }

        /* ===== SKELETON LOADER STYLES ===== */
        .skeleton {
            background: linear-gradient(90deg, #f3f4f6 0%, #e5e7eb 50%, #f3f4f6 100%);
            background-size: 200% 100%;
            animation: shimmerSkeleton 1.5s infinite;
            border-radius: 0.5rem;
        }

        @keyframes shimmerSkeleton {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* ===== LOADING STYLES ===== */
        .loading {
            display: none;
            text-align: center;
            padding: 3rem 2rem;
            background: white;
            border-radius: 1rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .loading.show {
            display: block;
        }

        .spinner {
            width: 40px;
            height: 40px;
            margin: 0 auto 1rem;
            border: 4px solid #f3f4f6;
            border-top: 4px solid #6366f1;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading p {
            color: #6b7280;
            margin: 0;
            font-size: 1rem;
            font-weight: 500;
        }

        body.dark-mode .loading {
            background: var(--card-bg);
        }

        body.dark-mode .loading p {
            color: var(--text-secondary);
        }

        body.dark-mode .spinner {
            border-color: var(--border-color);
            border-top-color: #6366f1;
        }

        /* ===== COMPREHENSIVE DARK MODE STYLES ===== */
        body.dark-mode .timeline-content,
        body.dark-mode .resource-card-modern,
        body.dark-mode .skeleton-card,
        body.dark-mode .tab {
            background: var(--card-bg);
            border-color: var(--border-color);
        }

        body.dark-mode .timeline-day-info h4,
        body.dark-mode .resource-card-title,
        body.dark-mode h1, body.dark-mode h2, body.dark-mode h3, body.dark-mode h4 {
            color: var(--text-primary);
        }

        body.dark-mode .timeline-date,
        body.dark-mode .resource-card-description,
        body.dark-mode p {
            color: var(--text-secondary);
        }

        body.dark-mode .toast {
            background: var(--card-bg);
            border-left-color: #10b981;
        }

        body.dark-mode .toast-title {
            color: var(--text-primary);
        }

        body.dark-mode .toast-message {
            color: var(--text-secondary);
        }

        body.dark-mode .resource-filters,
        body.dark-mode .filter-btn {
            background: var(--card-bg);
            border-color: var(--border-color);
            color: var(--text-primary);
        }

        body.dark-mode .search-bar {
            background: var(--card-bg);
            border-color: var(--border-color);
            color: var(--text-primary);
        }

        body.dark-mode .sidebar {
            background: var(--bg-secondary);
            border-right-color: var(--border-color);
        }

        body.dark-mode .sidebar-header h2 {
            color: var(--text-primary);
        }

        body.dark-mode .plan-card {
            background: var(--card-bg);
            border-color: var(--border-color);
        }

        body.dark-mode .plan-card h4 {
            color: var(--text-primary);
        }

        body.dark-mode .resource-favorite {
            background: var(--hover-bg);
            color: var(--text-secondary);
        }

        body.dark-mode .onboarding-card {
            background: var(--card-bg);
            border-color: var(--border-color);
        }

        body.dark-mode .quiz-option {
            background: var(--card-bg);
            border-color: var(--border-color);
        }

        body.dark-mode .quiz-option:hover {
            background: var(--hover-bg);
        }

        body.dark-mode .level-card {
            background: var(--card-bg);
            border-color: var(--border-color);
        }

        body.dark-mode .pricing-card {
            background: var(--card-bg);
            border-color: var(--border-color);
        }

        /* Additional Dark Mode for Main Dashboard Components */
        body.dark-mode .tabs-container {
            background: var(--card-bg);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }

        body.dark-mode .tabs {
            background: var(--bg-secondary);
            border-bottom-color: var(--border-color);
        }

        body.dark-mode .tab {
            color: var(--text-secondary);
        }

        body.dark-mode .tab.active {
            background: var(--card-bg);
            color: var(--text-primary);
        }

        body.dark-mode .tab-content {
            background: var(--card-bg);
        }

        body.dark-mode .results-container {
            background: var(--card-bg);
        }

        body.dark-mode .results-header {
            color: var(--text-primary);
        }

        body.dark-mode .new-plan-btn {
            background: #6366f1;
            color: white;
        }

        body.dark-mode .new-plan-btn:hover {
            background: #4f46e5;
        }

        body.dark-mode .results-header p {
            color: var(--text-secondary);
        }

        body.dark-mode .motivation-card {
            background: var(--card-bg);
            border-color: var(--border-color);
        }

        body.dark-mode .assessment-card {
            background: var(--card-bg);
            border-color: var(--border-color);
        }

        body.dark-mode input[type="text"],
        body.dark-mode input[type="email"],
        body.dark-mode input[type="number"],
        body.dark-mode select,
        body.dark-mode textarea {
            background: var(--bg-secondary);
            border-color: var(--border-color);
            color: var(--text-primary);
        }

        body.dark-mode label {
            color: var(--text-primary);
        }

        .skeleton-card {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            border: 1px solid #e5e7eb;
        }

        .skeleton-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .skeleton-title {
            height: 24px;
            width: 60%;
        }

        .skeleton-badge {
            height: 20px;
            width: 80px;
        }

        .skeleton-text {
            height: 16px;
            width: 100%;
            margin-bottom: 0.5rem;
        }

        .skeleton-text.short {
            width: 70%;
        }

        .skeleton-button {
            height: 40px;
            width: 120px;
            margin-top: 1rem;
        }

        /* ===== CONFETTI STYLES ===== */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            overflow: hidden;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #f59e0b;
            animation: confettiFall 3s linear forwards;
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* ===== SMOOTH PAGE TRANSITIONS ===== */
        .page-transition {
            animation: fadeInScale 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* ===== MICRO-INTERACTIONS ===== */
        .btn:active {
            transform: scale(0.97);
        }

        .interactive-element {
            transition: all 0.2s ease;
        }

        .interactive-element:hover {
            transform: translateY(-2px);
        }

        .bounce-on-hover:hover {
            animation: gentleBounce 0.6s ease;
        }

        @keyframes gentleBounce {
            0%, 100% { transform: translateY(0); }
            25% { transform: translateY(-5px); }
            50% { transform: translateY(0); }
            75% { transform: translateY(-2px); }
        }

        /* ===== HELP MODAL STYLES ===== */
        .help-button {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            z-index: 9997;
            color: white;
            font-weight: 700;
        }

        .help-button:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 35px -5px rgba(0, 0, 0, 0.3);
        }

        .help-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .help-modal.active {
            display: flex;
        }

        .help-modal-content {
            background: var(--card-bg);
            border-radius: 1.5rem;
            padding: 2rem;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            animation: fadeInScale 0.3s ease;
        }

        .help-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .help-modal-header h3 {
            margin: 0;
            color: var(--text-primary);
        }

        .help-modal-close {
            background: var(--hover-bg);
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 1.25rem;
            transition: all 0.2s ease;
        }

        .help-modal-close:hover {
            background: var(--border-color);
            color: var(--text-primary);
        }

        .shortcuts-section {
            margin-bottom: 1.5rem;
        }

        .shortcuts-section h4 {
            color: var(--text-primary);
            margin: 0 0 1rem 0;
            font-size: 1rem;
        }

        .shortcut-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
            background: var(--hover-bg);
        }

        .shortcut-keys {
            display: flex;
            gap: 0.375rem;
        }

        .key {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-family: 'Courier New', monospace;
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .shortcut-description {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        /* ===== MODERN ONBOARDING STYLES ===== */
        
        /* Progress Indicator */
        .onboarding-progress {
            margin-bottom: 2.5rem;
            padding: 1.5rem;
            background: rgba(99, 102, 241, 0.05);
            border-radius: 1rem;
        }

        .progress-steps {
            display: flex;
            align-items: center;
            justify-content: center;
            max-width: 600px;
            margin: 0 auto;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .step-circle {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: #e5e7eb;
            color: #9ca3af;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .progress-step.active .step-circle {
            background: linear-gradient(135deg, #6366f1, #4f46e5);
            color: white;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
            transform: scale(1.1);
        }

        .progress-step.completed .step-circle {
            background: #10b981;
            color: white;
        }

        .step-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: #6b7280;
        }

        .progress-step.active .step-label {
            color: #6366f1;
        }

        .progress-line {
            height: 3px;
            width: 80px;
            background: #e5e7eb;
            margin: 0 1rem;
            position: relative;
            top: -15px;
        }

        .progress-step.completed + .progress-line {
            background: #10b981;
        }

        /* Onboarding Steps */
        .onboarding-step {
            display: none;
            animation: fadeInSlide 0.4s ease;
        }

        .onboarding-step.active {
            display: block;
        }

        @keyframes fadeInSlide {
            from {
                opacity: 0;
                transform: translateY(15px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .step-card {
            background: var(--bg-primary);
            padding: 2.5rem;
            border-radius: 1.5rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid #e5e7eb;
        }

        .step-icon {
            font-size: 3.5rem;
            text-align: center;
            margin-bottom: 1rem;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        .step-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1f2937;
            text-align: center;
            margin-bottom: 0.5rem;
        }

        .step-subtitle {
            text-align: center;
            color: #6b7280;
            margin-bottom: 2rem;
            font-size: 1.05rem;
        }

        /* Quiz Styling */
        .quiz-section {
            margin: 2rem 0;
        }

        .quiz-question {
            font-size: 1.1rem;
            color: #1f2937;
            margin-bottom: 1.5rem;
            padding-left: 0.5rem;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .quiz-option {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.25rem 1.5rem;
            background: var(--text-primary);
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.05);
            transform: translateX(4px);
        }

        .quiz-option.selected {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.1);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
        }

        .option-badge {
            width: 38px;
            height: 38px;
            border-radius: 8px;
            background: #6366f1;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1rem;
            flex-shrink: 0;
        }

        .quiz-option.selected .option-badge {
            background: linear-gradient(135deg, #6366f1, #4f46e5);
        }

        .option-text {
            flex: 1;
            font-size: 0.975rem;
            color: var(--text-primary);
            font-weight: 500;
        }

        /* AI Suggestion Card */
        .ai-suggestion-card {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.08), rgba(16, 185, 129, 0.08));
            border: 2px solid #6366f1;
            border-radius: 1.25rem;
            padding: 2rem;
            text-align: center;
            margin: 2rem 0;
        }

        .ai-badge {
            display: inline-block;
            background: #6366f1;
            color: white;
            padding: 0.5rem 1.25rem;
            border-radius: 2rem;
            font-size: 0.875rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .suggested-level {
            margin-bottom: 1.5rem;
        }

        .level-icon-large {
            font-size: 4rem;
            margin-bottom: 1rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .suggested-level h4 {
            font-size: 1.75rem;
            font-weight: 700;
            color: #6366f1;
            margin-bottom: 0.5rem;
        }

        .suggested-level p {
            color: #6b7280;
            font-size: 1rem;
        }

        .btn-change-level {
            background: white;
            border: 2px solid #6366f1;
            color: #6366f1;
            padding: 0.75rem 1.75rem;
            border-radius: 0.75rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .btn-change-level:hover {
            background: #6366f1;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        /* Manual Level Selection */
        .level-selection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .level-choice-card {
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 1rem;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .level-choice-card:hover {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.05);
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }

        .level-choice-card.selected {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.1);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
        }

        .level-choice-icon {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
        }

        .level-choice-title {
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.25rem;
            font-size: 1rem;
        }

        .level-choice-desc {
            font-size: 0.825rem;
            color: #6b7280;
        }

        /* Premium Inline Banner */
        .premium-inline-banner {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            border-radius: 12px;
            padding: 1.25rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            margin: 2rem 0;
            color: white;
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);
        }

        .premium-content {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-wrap: wrap;
            flex: 1;
        }

        .premium-badge {
            background: rgba(255, 255, 255, 0.3);
            padding: 0.375rem 0.75rem;
            border-radius: 0.5rem;
            font-weight: 700;
            font-size: 0.8rem;
        }

        .premium-inline-btn {
            background: white;
            color: #f59e0b;
            border: none;
            padding: 0.75rem 1.75rem;
            border-radius: 0.75rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .premium-inline-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        /* Action Buttons */
        .step-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2.5rem;
            justify-content: center;
        }

        .btn-back,
        .btn-next,
        .btn-generate {
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-back {
            background: #f3f4f6;
            color: #6b7280;
            border: 2px solid #e5e7eb;
        }

        .btn-back:hover {
            border-color: #6366f1;
            color: #6366f1;
            transform: translateY(-2px);
        }

        .btn-next,
        .btn-generate {
            background: linear-gradient(135deg, #6366f1, #4f46e5);
            color: white;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .btn-next:hover,
        .btn-generate:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
        }

        .btn-next:disabled,
        .btn-generate:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-generate {
            background: linear-gradient(135deg, #10b981, #059669);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .btn-generate:hover {
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }

        /* Pricing Comparison Styles */
        .pricing-comparison {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
            margin: 2.5rem 0;
        }

        .pricing-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 1.25rem;
            padding: 2rem;
            position: relative;
            transition: all 0.3s ease;
        }

        .pricing-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
        }

        .premium-card {
            border-color: #6366f1;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.03), rgba(16, 185, 129, 0.03));
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.15);
        }

        .popular-badge {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 0.5rem 1.25rem;
            border-radius: 2rem;
            font-size: 0.75rem;
            font-weight: 700;
            letter-spacing: 0.5px;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);
        }

        .pricing-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid #e5e7eb;
        }

        .pricing-header h4 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 1rem;
        }

        .price {
            font-size: 3rem;
            font-weight: 800;
            color: var(--text-primary);
            line-height: 1;
        }

        .price span {
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        .price-note {
            margin-top: 0.5rem;
            font-size: 0.85rem;
            color: #10b981;
            font-weight: 600;
        }

        .pricing-features {
            margin-bottom: 2rem;
        }

        .pricing-features .feature {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 0;
            color: var(--text-primary);
        }

        .pricing-features .feature.disabled {
            color: var(--text-disabled);
        }

        .pricing-features .feature.disabled span {
            text-decoration: line-through;
        }

        .pricing-features .feature i {
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .pricing-btn {
            width: 100%;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .free-btn {
            background: #f3f4f6;
            color: #6b7280;
            border: 2px solid #e5e7eb;
        }

        .free-btn:hover {
            background: #e5e7eb;
            transform: translateY(-2px);
        }

        .premium-btn {
            background: linear-gradient(135deg, #6366f1, #4f46e5);
            color: white;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .premium-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
        }

        .trust-badges {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid #e5e7eb;
        }

        .university-logos {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .uni-badge {
            background: rgba(99, 102, 241, 0.1);
            color: #6366f1;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.9rem;
            font-weight: 600;
        }

        /* ===== STUDY PLANS SIDEBAR (LEFT SIDE) ===== */
        
        .study-plans-sidebar {
            position: fixed;
            top: 0;
            left: -380px;
            width: 380px;
            height: 100vh;
            background: white;
            box-shadow: 4px 0 20px rgba(0, 0, 0, 0.1);
            z-index: 2000;
            transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
        }

        .study-plans-sidebar.open {
            left: 0;
        }

        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-bottom: 2px solid #e5e7eb;
            position: sticky;
            top: 0;
            background: white;
            z-index: 10;
            background: var(--bg-primary);
        }

        .sidebar-header h3 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #1f2937;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .sidebar-header h3 i {
            color: #6366f1;
        }

        .sidebar-close {
            background: #f3f4f6;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
            transition: all 0.2s ease;
        }

        .sidebar-close:hover {
            background: #e5e7eb;
            color: #1f2937;
        }

        .sidebar-content {
            padding: 1rem;
            background: var(--bg-primary);
        }

        .no-plans {
            text-align: center;
            padding: 3rem 1rem;
            color: #9ca3af;
        }

        .no-plans i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .no-plans p {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .no-plans small {
            font-size: 0.875rem;
        }

        .plan-card {
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-primary);
        }

        .plan-card:hover {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.03);
            transform: translateX(-4px);
        }

        .plan-card.active {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.08);
        }

        .plan-card-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 0.75rem;
        }

        .plan-subject {
            font-weight: 700;
            color: var(--text-primary);
            font-size: 1.05rem;
            flex: 1;
        }

        .plan-level {
            background: #6366f1;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .plan-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.825rem;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }

        .plan-meta span {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .plan-date {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-top: 0.5rem;
        }

        .plan-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid #e5e7eb;
        }

        .plan-action-btn {
            flex: 1;
            padding: 0.5rem;
            border: none;
            border-radius: 6px;
            font-size: 0.825rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
        }

        .load-btn {
            background: #6366f1;
            color: white;
        }

        .load-btn:hover {
            background: #4f46e5;
            transform: translateY(-1px);
        }

        .delete-btn {
            background: #fef2f2;
            color: #ef4444;
        }

        .delete-btn:hover {
            background: #fee2e2;
        }

        /* Sidebar Toggle Button (LEFT SIDE) */
        .sidebar-toggle {
            position: fixed;
            top: 50%;
            left: 0;
            transform: translateY(-50%);
            background: linear-gradient(135deg, #6366f1, #4f46e5);
            color: white;
            border: none;
            padding: 1rem 0.75rem;
            border-radius: 0 8px 8px 0;
            cursor: pointer;
            z-index: 1500;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
            box-shadow: 2px 0 12px rgba(99, 102, 241, 0.3);
            transition: all 0.3s ease;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .sidebar-toggle:hover {
            transform: translateY(-50%) translateX(4px);
            box-shadow: 4px 0 20px rgba(99, 102, 241, 0.4);
        }

        .sidebar-toggle.hidden {
            left: 380px;
        }

        .sidebar-toggle i {
            font-size: 1.25rem;
        }

        /* Sidebar Overlay */
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Responsive Onboarding */
        @media (max-width: 768px) {
            .progress-steps {
                flex-direction: row;
                overflow-x: auto;
                padding-bottom: 0.5rem;
            }

            .progress-step {
                flex-shrink: 0;
            }

            .progress-line {
                width: 30px;
                height: 3px;
                margin: 0 0.5rem;
                top: -15px;
            }

            .step-card {
                padding: 1.75rem 1.25rem;
            }

            .step-title {
                font-size: 1.4rem;
            }

            /* Form grid adjustments for mobile */
            .form-grid {
                grid-template-columns: 1fr;
                gap: 1.25rem;
            }

            .input-group[style*="grid-column"] {
                grid-column: 1 !important;
            }

            .level-selection-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .premium-inline-banner {
                flex-direction: column;
                text-align: center;
            }

            .step-actions {
                flex-direction: column;
            }

            .btn-back,
            .btn-next,
            .btn-generate {
                width: 100%;
                justify-content: center;
            }

            .pricing-comparison {
                grid-template-columns: 1fr;
                gap: 2rem;
            }

            .popular-badge {
                font-size: 0.7rem;
                padding: 0.4rem 1rem;
            }

            .price {
                font-size: 2.5rem;
            }

            /* Sidebar mobile adjustments */
            .study-plans-sidebar {
                width: 100%;
                left: -100%;
            }

            .study-plans-sidebar.open {
                left: 0;
            }

            .sidebar-toggle {
                padding: 0.75rem 0.5rem;
                font-size: 0.7rem;
            }

            .sidebar-toggle.hidden {
                left: 100%;
            }
        }
    </style>
    
    <!-- User Assessment Styles -->
    <link rel="stylesheet" href="user-assessment.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo">
                <i class="fas fa-brain"></i>
                AI Study Planner
            </a>
            <div class="user-nav">
                <div class="nav-links">
                    <a href="index.html" class="nav-link">
                        <i class="fas fa-home"></i> Home
                    </a>
                    <button class="nav-link nav-new-plan-btn" onclick="startNewPlan()" style="background: none; border: none; cursor: pointer; color: inherit; font-size: inherit; padding: 0.75rem 1rem;">
                        <i class="fas fa-plus-circle"></i> New Plan
                    </button>
                </div>
                <div class="user-info" id="userDisplay">
                    <i class="fas fa-user-circle"></i>
                    <span>Loading...</span>
                </div>
                <button class="logout-btn" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>
    </nav>

    <!-- Study Plans Sidebar -->
    <div class="study-plans-sidebar" id="studyPlansSidebar">
        <div class="sidebar-header">
            <h3><i class="fas fa-history"></i> My Study Plans</h3>
            <button class="sidebar-close" onclick="toggleSidebar()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="sidebar-content" id="sidebarPlansContent">
            <div class="no-plans">
                <i class="fas fa-folder-open"></i>
                <p>No study plans yet</p>
                <small>Create your first plan to get started!</small>
            </div>
        </div>
    </div>

    <!-- Sidebar Toggle Button -->
    <button class="sidebar-toggle" id="sidebarToggle" onclick="toggleSidebar()">
        <i class="fas fa-history"></i>
        <span>Plans</span>
    </button>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Login Required State -->
            <div id="loginRequired" class="login-required" style="display: none;">
                <h2>🔒 Please Log In</h2>
                <p>You need to be logged in to access the AI Study Planner dashboard.</p>
                <a href="secure-auth.html">
                    <i class="fas fa-sign-in-alt"></i> Login / Register
                </a>
            </div>

            <!-- Main Dashboard -->
            <div id="mainContent" style="display: none;">
                <!-- Tabs Container -->
                <div class="tabs-container">
                    <div class="tabs">
                        <button class="tab active" onclick="switchTab('advanced')">
                            <i class="fas fa-rocket"></i> Advanced Planner
                        </button>
                        <button class="tab" onclick="switchTab('resources')">
                            <i class="fas fa-search"></i> Find Resources
                        </button>
                        <button class="tab" onclick="switchTab('motivation')">
                            <i class="fas fa-heart"></i> Get Motivated
                        </button>
                        <button class="tab" onclick="switchTab('progress')">
                            <i class="fas fa-chart-line"></i> My Progress
                        </button>
                    </div>

                    <!-- Advanced Planner Tab -->
                    <div id="advanced-tab" class="tab-content active">
                        <div class="tab-header">
                            <h2>🚀 Create Your Personalized Study Plan</h2>
                            <p>Answer a few quick questions and let our AI create the perfect learning journey for you.</p>
                        </div>

                        <!-- Modern Onboarding Assessment -->
                        <div id="onboarding-assessment">
                            <!-- Progress Indicator -->
                            <div class="onboarding-progress">
                                <div class="progress-steps">
                                    <div class="progress-step active" data-step="1">
                                        <div class="step-circle">1</div>
                                        <div class="step-label">Subject</div>
                                    </div>
                                    <div class="progress-line"></div>
                                    <div class="progress-step" data-step="2">
                                        <div class="step-circle">2</div>
                                        <div class="step-label">Assessment</div>
                                    </div>
                                    <div class="progress-line"></div>
                                    <div class="progress-step" data-step="3">
                                        <div class="step-circle">3</div>
                                        <div class="step-label">Level</div>
                                    </div>
                                    <div class="progress-line"></div>
                                    <div class="progress-step" data-step="4">
                                        <div class="step-circle">4</div>
                                        <div class="step-label">Plan</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 1: Subject & Time -->
                            <div class="onboarding-step active" id="onboarding-step-1">
                                <div class="step-card">
                                    <div class="step-icon">🎯</div>
                                    <h3 class="step-title">What do you want to learn?</h3>
                                    <p class="step-subtitle">Tell us your subject and available time</p>

                                    <div class="form-grid" style="margin-top: 2rem;">
                                        <!-- Subject in full width row -->
                                        <div class="input-group" style="grid-column: 1 / -1;">
                                            <label for="onboardingSubject">
                                                <i class="fas fa-book"></i> Subject or Topic
                                            </label>
                                            <input type="text" id="onboardingSubject" 
                                                   placeholder="e.g., Machine Learning, Calculus, Spanish..." 
                                                   list="onboardingSubjectList"
                                                   style="font-size: 1.1rem; padding: 0.875rem;">
                                            <datalist id="onboardingSubjectList">
                                                <option value="Machine Learning">
                                                <option value="Python Programming">
                                                <option value="Data Science">
                                                <option value="Web Development">
                                                <option value="Calculus">
                                                <option value="Organic Chemistry">
                                                <option value="Spanish Language">
                                                <option value="Digital Marketing">
                                            </datalist>
                                        </div>

                                        <!-- Daily Study Time and Study Duration in second row -->
                                        <div class="input-group">
                                            <label for="onboardingDailyHours">
                                                <i class="fas fa-clock"></i> Daily Study Time
                                            </label>
                                            <select id="onboardingDailyHours">
                                                <option value="1">1 hour</option>
                                                <option value="2" selected>2 hours</option>
                                                <option value="3">3 hours</option>
                                                <option value="4">4 hours</option>
                                                <option value="5">5+ hours</option>
                                            </select>
                                        </div>

                                        <div class="input-group">
                                            <label for="onboardingTotalDays">
                                                <i class="fas fa-calendar-alt"></i> Study Duration
                                            </label>
                                            <select id="onboardingTotalDays" onchange="toggleCustomDurationOnboarding()">
                                                <option value="3">3 days</option>
                                                <option value="7" selected>1 week</option>
                                                <option value="14">2 weeks</option>
                                                <option value="30">1 month</option>
                                                <option value="60">2 months</option>
                                                <option value="custom">Custom Duration</option>
                                            </select>
                                        </div>

                                        <!-- Custom Duration field (full width when visible) -->
                                        <div class="input-group" id="customDurationOnboarding" style="display: none; grid-column: 1 / -1;">
                                            <label for="customDaysOnboarding">
                                                <i class="fas fa-calendar-plus"></i> Custom Days (1-365)
                                            </label>
                                            <input 
                                                type="number" 
                                                id="customDaysOnboarding" 
                                                min="1" 
                                                max="365" 
                                                placeholder="Enter number of days (1-365)"
                                                style="padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 0.5rem; font-size: 1rem; max-width: 400px;">
                                        </div>
                                    </div>

                                    <div class="step-actions">
                                        <button class="btn-next" onclick="goToOnboardingStep(2)" id="step1NextBtn">
                                            Continue <i class="fas fa-arrow-right"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 2: Quick Assessment -->
                            <div class="onboarding-step" id="onboarding-step-2">
                                <div class="step-card">
                                    <div class="step-icon">🧠</div>
                                    <h3 class="step-title">Quick Knowledge Check</h3>
                                    <p class="step-subtitle">Help us understand your current level (3 questions)</p>

                                    <!-- Question 1 -->
                                    <div class="quiz-section" id="quiz-q1">
                                        <p class="quiz-question">
                                            <strong>Question 1 of 3:</strong> Have you studied <span id="quizSubject1">this subject</span> before?
                                        </p>
                                        <div class="quiz-options">
                                            <div class="quiz-option" onclick="selectQuizOption(1, 'never', this)">
                                                <div class="option-badge">A</div>
                                                <div class="option-text">Never - This is completely new to me</div>
                                            </div>
                                            <div class="quiz-option" onclick="selectQuizOption(1, 'briefly', this)">
                                                <div class="option-badge">B</div>
                                                <div class="option-text">Briefly - I know a few basic concepts</div>
                                            </div>
                                            <div class="quiz-option" onclick="selectQuizOption(1, 'somewhat', this)">
                                                <div class="option-badge">C</div>
                                                <div class="option-text">Somewhat - I have a basic foundation</div>
                                            </div>
                                            <div class="quiz-option" onclick="selectQuizOption(1, 'well', this)">
                                                <div class="option-badge">D</div>
                                                <div class="option-text">Well - I'm comfortable with fundamentals</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Question 2 -->
                                    <div class="quiz-section" id="quiz-q2" style="display: none;">
                                        <p class="quiz-question">
                                            <strong>Question 2 of 3:</strong> How confident are you in learning <span id="quizSubject2">this subject</span>?
                                        </p>
                                        <div class="quiz-options">
                                            <div class="quiz-option" onclick="selectQuizOption(2, 'nervous', this)">
                                                <div class="option-badge">A</div>
                                                <div class="option-text">Nervous - This seems challenging</div>
                                            </div>
                                            <div class="quiz-option" onclick="selectQuizOption(2, 'cautious', this)">
                                                <div class="option-badge">B</div>
                                                <div class="option-text">Cautious - I'll need guidance</div>
                                            </div>
                                            <div class="quiz-option" onclick="selectQuizOption(2, 'confident', this)">
                                                <div class="option-badge">C</div>
                                                <div class="option-text">Confident - I can handle this</div>
                                            </div>
                                            <div class="quiz-option" onclick="selectQuizOption(2, 'very-confident', this)">
                                                <div class="option-badge">D</div>
                                                <div class="option-text">Very Confident - Bring on the challenge!</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Question 3 -->
                                    <div class="quiz-section" id="quiz-q3" style="display: none;">
                                        <p class="quiz-question">
                                            <strong>Question 3 of 3:</strong> What's your learning goal?
                                        </p>
                                        <div class="quiz-options">
                                            <div class="quiz-option" onclick="selectQuizOption(3, 'basics', this)">
                                                <div class="option-badge">A</div>
                                                <div class="option-text">Master the basics and fundamentals</div>
                                            </div>
                                            <div class="quiz-option" onclick="selectQuizOption(3, 'intermediate', this)">
                                                <div class="option-badge">B</div>
                                                <div class="option-text">Build intermediate-level knowledge</div>
                                            </div>
                                            <div class="quiz-option" onclick="selectQuizOption(3, 'advanced', this)">
                                                <div class="option-badge">C</div>
                                                <div class="option-text">Achieve advanced proficiency</div>
                                            </div>
                                            <div class="quiz-option" onclick="selectQuizOption(3, 'expert', this)">
                                                <div class="option-badge">D</div>
                                                <div class="option-text">Become an expert in the field</div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="step-actions">
                                        <button class="btn-back" onclick="goToOnboardingStep(1)">
                                            <i class="fas fa-arrow-left"></i> Back
                                        </button>
                                        <button class="btn-next" onclick="analyzeAndShowLevel()" id="step2NextBtn" disabled>
                                            Analyze My Level <i class="fas fa-magic"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 3: AI Suggestion -->
                            <div class="onboarding-step" id="onboarding-step-3">
                                <div class="step-card">
                                    <div class="step-icon">🤖</div>
                                    <h3 class="step-title">AI Analysis Complete!</h3>
                                    <p class="step-subtitle">Based on your responses, here's our recommendation</p>

                                    <div class="ai-suggestion-card">
                                        <div class="ai-badge">
                                            <i class="fas fa-robot"></i> AI Recommended
                                        </div>
                                        <div class="suggested-level">
                                            <div class="level-icon-large" id="suggestedLevelIcon">🌱</div>
                                            <h4 id="suggestedLevelText">BEGINNER</h4>
                                            <p id="suggestedLevelDesc">Perfect for those starting fresh with fundamentals</p>
                                        </div>
                                        <button class="btn-change-level" onclick="toggleManualLevel()">
                                            <i class="fas fa-edit"></i> Change Level
                                        </button>
                                    </div>

                                    <!-- Manual Level Selection -->
                                    <div id="manualLevelSection" style="display: none;">
                                        <p style="text-align: center; margin: 1.5rem 0 1rem; font-weight: 600; color: #6b7280;">
                                            Choose your preferred level:
                                        </p>
                                        <div class="level-selection-grid">
                                            <div class="level-choice-card" onclick="selectManualLevel('beginner', '🌱', 'Beginner', 'Start from scratch')">
                                                <div class="level-choice-icon">🌱</div>
                                                <div class="level-choice-title">Beginner</div>
                                                <div class="level-choice-desc">Start from scratch</div>
                                            </div>
                                            <div class="level-choice-card" onclick="selectManualLevel('intermediate', '🌿', 'Intermediate', 'Build on basics')">
                                                <div class="level-choice-icon">🌿</div>
                                                <div class="level-choice-title">Intermediate</div>
                                                <div class="level-choice-desc">Build on basics</div>
                                            </div>
                                            <div class="level-choice-card" onclick="selectManualLevel('advanced', '🌳', 'Advanced', 'Deep expertise')">
                                                <div class="level-choice-icon">🌳</div>
                                                <div class="level-choice-title">Advanced</div>
                                                <div class="level-choice-desc">Deep expertise</div>
                                            </div>
                                            <div class="level-choice-card" onclick="selectManualLevel('expert', '🏔️', 'Expert', 'Master level')">
                                                <div class="level-choice-icon">🏔️</div>
                                                <div class="level-choice-title">Expert</div>
                                                <div class="level-choice-desc">Master level</div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="step-actions">
                                        <button class="btn-back" onclick="goToOnboardingStep(2)">
                                            <i class="fas fa-arrow-left"></i> Back
                                        </button>
                                        <button class="btn-next" onclick="goToOnboardingStep(4)">
                                            Continue <i class="fas fa-arrow-right"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 4: Premium Comparison -->
                            <div class="onboarding-step" id="onboarding-step-4">
                                <div class="step-card" style="max-width: 900px; margin: 0 auto;">
                                    <div class="step-icon">💎</div>
                                    <h3 class="step-title">Unlock Better Grades & Save Study Time</h3>
                                    <p class="step-subtitle">Choose the plan that works best for you</p>

                                    <div class="pricing-comparison">
                                        <!-- Free Plan -->
                                        <div class="pricing-card free-card">
                                            <div class="pricing-header">
                                                <h4>Free Plan</h4>
                                                <div class="price">$0<span>/month</span></div>
                                            </div>
                                            <div class="pricing-features">
                                                <div class="feature">
                                                    <i class="fas fa-check" style="color: #10b981;"></i>
                                                    <span>Basic study plans (3 days)</span>
                                                </div>
                                                <div class="feature">
                                                    <i class="fas fa-check" style="color: #10b981;"></i>
                                                    <span>Limited resources (3 per topic)</span>
                                                </div>
                                                <div class="feature disabled">
                                                    <i class="fas fa-times" style="color: #ef4444;"></i>
                                                    <span>Progress tracking</span>
                                                </div>
                                                <div class="feature disabled">
                                                    <i class="fas fa-times" style="color: #ef4444;"></i>
                                                    <span>AI motivation coach</span>
                                                </div>
                                                <div class="feature disabled">
                                                    <i class="fas fa-times" style="color: #ef4444;"></i>
                                                    <span>Calendar integration</span>
                                                </div>
                                                <div class="feature disabled">
                                                    <i class="fas fa-times" style="color: #ef4444;"></i>
                                                    <span>Priority support</span>
                                                </div>
                                            </div>
                                            <button class="pricing-btn free-btn" onclick="continueWithFree()">
                                                Continue with Free
                                            </button>
                                        </div>

                                        <!-- Premium Plan -->
                                        <div class="pricing-card premium-card">
                                            <div class="popular-badge">
                                                <i class="fas fa-star"></i> MOST POPULAR
                                            </div>
                                            <div class="pricing-header">
                                                <h4>Premium</h4>
                                                <div class="price">$4.99<span>/month</span></div>
                                                <div class="price-note">Save 60% with yearly plan</div>
                                            </div>
                                            <div class="pricing-features">
                                                <div class="feature">
                                                    <i class="fas fa-check" style="color: #10b981;"></i>
                                                    <span><strong>Unlimited</strong> study plans</span>
                                                </div>
                                                <div class="feature">
                                                    <i class="fas fa-check" style="color: #10b981;"></i>
                                                    <span><strong>Advanced</strong> AI tutor mode</span>
                                                </div>
                                                <div class="feature">
                                                    <i class="fas fa-check" style="color: #10b981;"></i>
                                                    <span>Unlimited resources & materials</span>
                                                </div>
                                                <div class="feature">
                                                    <i class="fas fa-check" style="color: #10b981;"></i>
                                                    <span>Progress analytics dashboard</span>
                                                </div>
                                                <div class="feature">
                                                    <i class="fas fa-check" style="color: #10b981;"></i>
                                                    <span>AI motivation & coaching</span>
                                                </div>
                                                <div class="feature">
                                                    <i class="fas fa-check" style="color: #10b981;"></i>
                                                    <span>Calendar sync & reminders</span>
                                                </div>
                                                <div class="feature">
                                                    <i class="fas fa-check" style="color: #10b981;"></i>
                                                    <span>Priority support</span>
                                                </div>
                                            </div>
                                            <button class="pricing-btn premium-btn" onclick="showPremiumModal()">
                                                <i class="fas fa-crown"></i> Unlock Premium
                                            </button>
                                        </div>
                                    </div>

                                    <div class="trust-badges">
                                        <p style="text-align: center; color: #6b7280; margin-bottom: 1rem;">
                                            Trusted by students from top universities
                                        </p>
                                        <div class="university-logos">
                                            <span class="uni-badge">🎓 Stanford</span>
                                            <span class="uni-badge">🎓 Harvard</span>
                                            <span class="uni-badge">🎓 MIT</span>
                                            <span class="uni-badge">🎓 Yale</span>
                                        </div>
                                    </div>

                                    <div class="step-actions">
                                        <button class="btn-back" onclick="goToOnboardingStep(3)">
                                            <i class="fas fa-arrow-left"></i> Back
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="loading" id="advanced-loading">
                            <div class="spinner"></div>
                            <p>Our AI agents are creating your personalized study plan...</p>
                        </div>

                        <div id="advanced-results"></div>
                    </div>

                    <!-- Onboarding Functions - Define immediately for onclick handlers -->
                    <script>
                        // Quick stub definitions to prevent "not defined" errors
                        // These will be properly overridden by the main script below
                        if (typeof goToOnboardingStep === 'undefined') {
                            window.goToOnboardingStep = function() { console.log('Waiting for main script...'); };
                            window.selectQuizOption = function() { console.log('Waiting for main script...'); };
                            window.analyzeAndShowLevel = function() { console.log('Waiting for main script...'); };
                            window.toggleManualLevel = function() { console.log('Waiting for main script...'); };
                            window.selectManualLevel = function() { console.log('Waiting for main script...'); };
                            window.continueWithFree = function() { console.log('Waiting for main script...'); };
                            window.showPremiumModal = function() { console.log('Waiting for main script...'); };
                            window.startNewPlan = function() { console.log('Waiting for main script...'); };
                        }
                    </script>

                    <!-- Resources Tab -->
                    <div id="resources-tab" class="tab-content">
                        <div class="tab-header">
                            <h2>📚 Resource Finder</h2>
                            <p>Discover the best learning resources curated by our AI-powered information retrieval system.</p>
                        </div>

                        <div class="form-grid">
                            <div class="input-group">
                                <label for="resourceSubject">
                                    <i class="fas fa-book-open"></i> Subject
                                </label>
                                <input type="text" id="resourceSubject" placeholder="Enter any subject to find resources..." list="resourceSubjectList">
                                <datalist id="resourceSubjectList">
                                    <!-- Suggestions will be loaded here -->
                                </datalist>
                                <small class="input-help">Start typing or select from popular suggestions</small>
                            </div>
                            <div class="input-group">
                                <label for="resourceType">
                                    <i class="fas fa-filter"></i> Resource Type
                                </label>
                                <select id="resourceType">
                                    <option value="">All Types</option>
                                    <option value="course">Online Courses</option>
                                    <option value="tutorial">Tutorials</option>
                                    <option value="book">Books</option>
                                    <option value="video">Videos</option>
                                    <option value="article">Articles</option>
                                </select>
                            </div>
                        </div>
                        
                        <button class="generate-btn" onclick="findResources()">
                            <i class="fas fa-search"></i> Find Best Resources
                        </button>

                        <div class="loading" id="resources-loading">
                            <div class="spinner"></div>
                            <p>Searching through our curated database...</p>
                        </div>

                        <div id="resources-results"></div>
                    </div>

                    <!-- Motivation Tab -->
                    <div id="motivation-tab" class="tab-content">
                        <div class="tab-header">
                            <h2>💪 Motivation Coach</h2>
                            <p>Get personalized motivation, study tips, and encouragement from our AI coach.</p>
                        </div>

                        <div class="input-group">
                            <label for="currentMood">
                                <i class="fas fa-comment"></i> How are you feeling about your studies?
                            </label>
                            <input type="text" id="currentMood" placeholder="e.g., I'm struggling with calculus, feeling overwhelmed, excited about learning..." style="min-height: 100px;">
                        </div>
                        
                        <button class="generate-btn" onclick="getMotivation()">
                            <i class="fas fa-heart"></i> Get Personalized Motivation
                        </button>

                        <div class="loading" id="motivation-loading">
                            <div class="spinner"></div>
                            <p>Analyzing your mood and crafting personalized motivation...</p>
                        </div>

                        <div id="motivation-results"></div>
                    </div>

                    <!-- Progress Tab -->
                    <div id="progress-tab" class="tab-content">
                        <div class="tab-header">
                            <h2>🎮 My Progress</h2>
                            <p>Track your daily study hours and maintain your learning streak!</p>
                        </div>

                        <!-- Study Streak Counter -->
                        <div class="streak-counter">
                            <div class="streak-flame">🔥</div>
                            <div class="streak-info">
                                <div class="streak-number" id="streakNumber">0</div>
                                <div class="streak-label">Day Streak</div>
                            </div>
                            <div class="streak-message" id="streakMessage">Start your journey!</div>
                        </div>

                        <!-- Overall Progress -->
                        <div class="progress-overview">
                            <div class="progress-card">
                                <h3>📊 Current Study Plan</h3>
                                <div id="currentPlanInfo">
                                    <p>Create a study plan to start tracking!</p>
                                </div>
                                
                                <!-- Overall Progress Bar -->
                                <div class="progress-container" id="overallProgressContainer" style="display: none;">
                                    <div class="progress-header">
                                        <span>Overall Progress</span>
                                        <span class="progress-percentage" id="overallPercentage">0%</span>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar" id="overallProgressBar"></div>
                                        <div class="progress-spark" id="overallSpark"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Daily Tracking Grid -->
                        <div class="daily-tracking" id="dailyTrackingSection" style="display: none;">
                            <h3>📅 Daily Progress</h3>
                            <div class="daily-grid" id="dailyGrid">
                                <!-- Daily boxes will be generated here -->
                            </div>
                            
                            <!-- Quick Actions -->
                            <div class="quick-actions">
                                <button class="action-btn" onclick="markTodayComplete()">
                                    <i class="fas fa-check"></i> Complete Today
                                </button>
                                <button class="action-btn secondary" onclick="resetProgress()">
                                    <i class="fas fa-refresh"></i> Reset Progress
                                </button>
                            </div>
                        </div>

                        <!-- Achievements Section -->
                        <div class="achievements-section" id="achievementsSection">
                            <h3>🏆 Achievements</h3>
                            <div class="achievements-grid" id="achievementsGrid">
                                <div class="achievement locked" data-achievement="first-day">
                                    <div class="achievement-icon">🎯</div>
                                    <div class="achievement-name">First Day</div>
                                    <div class="achievement-desc">Complete your first study session</div>
                                </div>
                                <div class="achievement locked" data-achievement="three-streak">
                                    <div class="achievement-icon">🔥</div>
                                    <div class="achievement-name">Hot Streak</div>
                                    <div class="achievement-desc">Study for 3 days in a row</div>
                                </div>
                                <div class="achievement locked" data-achievement="week-warrior">
                                    <div class="achievement-icon">⚡</div>
                                    <div class="achievement-name">Week Warrior</div>
                                    <div class="achievement-desc">Complete a full week</div>
                                </div>
                                <div class="achievement locked" data-achievement="perfect-week">
                                    <div class="achievement-icon">💎</div>
                                    <div class="achievement-name">Perfect Week</div>
                                    <div class="achievement-desc">100% completion for 7 days</div>
                                </div>
                            </div>
                        </div>

                        <!-- Celebration Overlay -->
                        <div class="celebration-overlay" id="celebrationOverlay">
                            <div class="confetti" id="confetti"></div>
                                                       <div class="celebration-message" id="celebrationMessage">
                                <div class="celebration-icon">🎉</div>
                                <div class="celebration-text">Congratulations!</div>
                                <div class="celebration-subtext">You're making great progress!</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modern Onboarding JavaScript -->
    <script>
        // Onboarding State
        let onboardingData = {
            subject: '',
            dailyHours: '2',
            totalDays: '7',
            q1: '',
            q2: '',
            q3: '',
            suggestedLevel: '',
            selectedLevel: ''
        };

        let currentOnboardingStep = 1;
        let quizProgress = 0;

        // Initialize onboarding
        document.addEventListener('DOMContentLoaded', function() {
            setupOnboardingListeners();
        });

        function setupOnboardingListeners() {
            // Subject input
            const subjectInput = document.getElementById('onboardingSubject');
            if (subjectInput) {
                subjectInput.addEventListener('input', (e) => {
                    onboardingData.subject = e.target.value.trim();
                    updateStep1Button();
                });
            }

            // Daily hours select
            const dailyHoursSelect = document.getElementById('onboardingDailyHours');
            if (dailyHoursSelect) {
                dailyHoursSelect.addEventListener('change', (e) => {
                    onboardingData.dailyHours = e.target.value;
                });
            }

            // Total days select
            const totalDaysSelect = document.getElementById('onboardingTotalDays');
            if (totalDaysSelect) {
                totalDaysSelect.addEventListener('change', (e) => {
                    if (e.target.value === 'custom') {
                        // Custom duration will be read from customDaysOnboarding input
                        const customInput = document.getElementById('customDaysOnboarding');
                        if (customInput && customInput.value) {
                            onboardingData.totalDays = parseInt(customInput.value);
                        }
                    } else {
                        onboardingData.totalDays = e.target.value;
                    }
                });
            }

            // Custom days input
            const customDaysInput = document.getElementById('customDaysOnboarding');
            if (customDaysInput) {
                customDaysInput.addEventListener('input', (e) => {
                    const days = parseInt(e.target.value);
                    if (days && days >= 1 && days <= 365) {
                        onboardingData.totalDays = days;
                    }
                });
            }
        }

        function updateStep1Button() {
            const btn = document.getElementById('step1NextBtn');
            const subjectInput = document.getElementById('onboardingSubject');
            if (btn && subjectInput) {
                const hasSubject = subjectInput.value.trim().length > 0;
                btn.disabled = !hasSubject;
                if (hasSubject) {
                    onboardingData.subject = subjectInput.value.trim();
                }
            }
        }

        window.toggleCustomDurationOnboarding = function() {
            const select = document.getElementById('onboardingTotalDays');
            const customInput = document.getElementById('customDurationOnboarding');
            if (select && customInput) {
                if (select.value === 'custom') {
                    customInput.style.display = 'block';
                } else {
                    customInput.style.display = 'none';
                }
            }
        }

        // ===== ETHICAL CONTENT VALIDATION =====
        function validateEthicalContent(subject) {
            console.log('[ETHICS] Validating subject:', subject);
            
            const subjectLower = subject.toLowerCase();
            
            // Comprehensive blocked keywords list
            const blockedKeywords = {
                'Violence & Harm': [
                    'suicide', 'suicidal', 'kill', 'killing', 'murder', 'murderer', 'assassin', 
                    'assassination', 'bomb', 'bombing', 'explosive', 'weapon', 'weaponize', 
                    'gun', 'firearm', 'rifle', 'pistol', 'knife attack', 'stabbing', 'stab',
                    'terrorist', 'terrorism', 'terror attack', 'mass shooting', 'school shooting',
                    'serial killer', 'homicide', 'genocide', 'war crime', 'torture', 'execution',
                    'death penalty', 'vigilante', 'lynch', 'poison', 'poisoning', 'strangle'
                ],
                'Illegal Hacking & Cybercrime': [
                    'black hat', 'blackhat', 'crack software', 'cracking', 'piracy', 'pirate software',
                    'warez', 'keygen', 'crack password', 'password cracker', 'brute force attack',
                    'hack bank', 'hack account', 'hack website', 'hack system', 'hack network',
                    'break into system', 'break into account', 'unauthorized access', 'bypass security',
                    'exploit kit', 'zero-day exploit', 'malware creation', 'virus creation',
                    'ransomware', 'create virus', 'ddos attack', 'dos attack', 'botnet',
                    'phishing kit', 'credential stuffing', 'session hijacking', 'sql injection',
                    'xss attack', 'man in the middle', 'keylogger', 'trojan', 'backdoor',
                    'rootkit', 'spyware', 'adware creation'
                ],
                'Illegal Activities & Fraud': [
                    'steal', 'stealing', 'theft', 'rob', 'robbery', 'burglary', 'fraud',
                    'scam', 'scamming', 'ponzi scheme', 'pyramid scheme', 'identity theft',
                    'credit card fraud', 'fake id', 'counterfeit', 'forgery', 'money laundering',
                    'tax evasion', 'insider trading', 'embezzlement', 'bribery', 'corruption',
                    'smuggling', 'trafficking', 'illegal trade'
                ],
                'Drugs & Illegal Substances': [
                    'meth', 'methamphetamine', 'meth production', 'meth lab', 'cocaine',
                    'cocaine production', 'heroin', 'heroin production', 'fentanyl', 'fentanyl synthesis',
                    'drug dealing', 'drug manufacturing', 'drug production', 'drug trafficking',
                    'illegal drugs', 'narcotics production', 'lsd production', 'mdma production',
                    'ecstasy production', 'crack cocaine', 'opium', 'cannabis cultivation illegal'
                ],
                'Self-Harm & Dangerous Behavior': [
                    'self-harm', 'self harm', 'cut myself', 'cutting myself', 'hurt myself',
                    'hurting myself', 'self-mutilation', 'self injury', 'eating disorder',
                    'anorexia tips', 'bulimia tips', 'purging', 'pro ana', 'pro mia',
                    'suicide method', 'how to die', 'overdose intentionally', 'jump off',
                    'hang myself', 'end my life'
                ],
                'Sexual Abuse & Exploitation': [
                    'child porn', 'child pornography', 'cp', 'sexual assault', 'rape',
                    'child abuse', 'child exploitation', 'child molest', 'pedophilia',
                    'human trafficking', 'sex trafficking', 'sexual predator', 'grooming children',
                    'revenge porn', 'non-consensual', 'sexual harassment'
                ],
                'Hate Speech & Discrimination': [
                    'white supremacy', 'white supremacist', 'white power', 'nazi', 'neo-nazi',
                    'fascism', 'hate group', 'ethnic cleansing', 'racial violence', 'hate crime',
                    'lynching', 'ku klux klan', 'kkk', 'genocide', 'holocaust denial',
                    'racial supremacy', 'racist ideology', 'sexist ideology'
                ],
                'Dangerous Materials & Weapons': [
                    'make bomb', 'build bomb', 'create explosive', 'pipe bomb', 'fertilizer bomb',
                    'pressure cooker bomb', 'molotov cocktail', 'chemical weapon', 'biological weapon',
                    'bioweapon', 'nerve agent', 'sarin gas', 'anthrax', 'ricin', 'cyanide',
                    'radioactive material', 'dirty bomb', 'nuclear weapon', 'uranium enrichment'
                ]
            };

            // Check against all blocked keywords
            for (const [category, keywords] of Object.entries(blockedKeywords)) {
                for (const keyword of keywords) {
                    if (subjectLower.includes(keyword)) {
                        console.log(`[ETHICS] ❌ BLOCKED - Category: "${category}", Keyword: "${keyword}"`);
                        
                        // Show detailed error message
                        showEthicalViolationError(category, keyword);
                        return false;
                    }
                }
            }
            
            console.log('[ETHICS] ✅ Content validation passed');
            return true;
        }

        function showEthicalViolationError(category, keyword) {
            // Create error modal
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                padding: 1rem;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 1rem; max-width: 600px; width: 100%; padding: 2rem; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                    <div style="text-align: center; margin-bottom: 1.5rem;">
                        <div style="font-size: 4rem; margin-bottom: 0.5rem;">⚠️</div>
                        <h2 style="color: #dc2626; margin: 0 0 0.5rem 0; font-size: 1.75rem;">Content Policy Violation</h2>
                        <p style="color: #64748b; margin: 0; font-size: 1rem;">Detected: <strong>${category}</strong></p>
                    </div>
                    
                    <div style="background: #fee2e2; border-left: 4px solid #dc2626; padding: 1.25rem; margin: 1.5rem 0; border-radius: 0.5rem;">
                        <p style="margin: 0 0 1rem 0; color: #991b1b; font-weight: 600;">
                            🚫 Our AI Study Planner is designed exclusively for educational purposes.
                        </p>
                        <p style="margin: 0; color: #991b1b; line-height: 1.6;">
                            We cannot generate study plans for topics involving violence, illegal activities, 
                            self-harm, discrimination, or any content that could cause harm.
                        </p>
                    </div>
                    
                    <div style="background: #f0fdf4; border: 1px solid #bbf7d0; padding: 1.25rem; margin: 1.5rem 0; border-radius: 0.5rem;">
                        <p style="margin: 0 0 0.75rem 0; color: #166534; font-weight: 600;">
                            ✅ Try these educational topics instead:
                        </p>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.5rem;">
                            <span style="background: white; color: #166534; padding: 0.5rem; border-radius: 0.5rem; font-size: 0.9rem; text-align: center; border: 1px solid #bbf7d0;">📊 Data Science</span>
                            <span style="background: white; color: #166534; padding: 0.5rem; border-radius: 0.5rem; font-size: 0.9rem; text-align: center; border: 1px solid #bbf7d0;">💻 Programming</span>
                            <span style="background: white; color: #166534; padding: 0.5rem; border-radius: 0.5rem; font-size: 0.9rem; text-align: center; border: 1px solid #bbf7d0;">📐 Mathematics</span>
                            <span style="background: white; color: #166534; padding: 0.5rem; border-radius: 0.5rem; font-size: 0.9rem; text-align: center; border: 1px solid #bbf7d0;">🔬 Science</span>
                            <span style="background: white; color: #166534; padding: 0.5rem; border-radius: 0.5rem; font-size: 0.9rem; text-align: center; border: 1px solid #bbf7d0;">🌐 Languages</span>
                            <span style="background: white; color: #166534; padding: 0.5rem; border-radius: 0.5rem; font-size: 0.9rem; text-align: center; border: 1px solid #bbf7d0;">🎨 Design</span>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 2rem;">
                        <button onclick="this.closest('div[style*=\"position: fixed\"]').remove(); document.getElementById('onboardingSubject').focus();" 
                                style="background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); 
                                       color: white; 
                                       border: none; 
                                       padding: 1rem 2.5rem; 
                                       border-radius: 0.75rem; 
                                       font-size: 1.1rem; 
                                       font-weight: 700; 
                                       cursor: pointer;
                                       box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
                                       transition: all 0.3s ease;">
                            Choose a Different Topic
                        </button>
                    </div>
                </div>
            `;
            
            // Add hover effect to button
            const button = modal.querySelector('button');
            button.addEventListener('mouseenter', () => {
                button.style.transform = 'translateY(-2px)';
                button.style.boxShadow = '0 6px 20px rgba(99, 102, 241, 0.5)';
            });
            button.addEventListener('mouseleave', () => {
                button.style.transform = 'translateY(0)';
                button.style.boxShadow = '0 4px 12px rgba(99, 102, 241, 0.4)';
            });
            
            document.body.appendChild(modal);
            
            // Close on backdrop click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                    document.getElementById('onboardingSubject').focus();
                }
            });
        }

        window.goToOnboardingStep = function(step) {
            // Validate before moving forward
            if (step > currentOnboardingStep) {
                if (currentOnboardingStep === 1) {
                    const subjectInput = document.getElementById('onboardingSubject');
                    const subject = subjectInput ? subjectInput.value.trim() : '';
                    if (!subject) {
                        alert('Please enter a subject you want to learn!');
                        if (subjectInput) subjectInput.focus();
                        return;
                    }
                    
                    // ETHICAL CONTENT VALIDATION - Check before proceeding to Step 2
                    if (!validateEthicalContent(subject)) {
                        console.log('[ETHICS] ❌ Subject blocked at Step 1');
                        return; // Stop here, don't proceed to next step
                    }
                    
                    onboardingData.subject = subject;
                }
            }

            // Hide current step
            const currentStep = document.getElementById(`onboarding-step-${currentOnboardingStep}`);
            if (currentStep) {
                currentStep.classList.remove('active');
            }

            // Update progress indicators
            document.querySelectorAll('.progress-step').forEach((el, index) => {
                if (index + 1 < step) {
                    el.classList.add('completed');
                    el.classList.remove('active');
                } else if (index + 1 === step) {
                    el.classList.add('active');
                    el.classList.remove('completed');
                } else {
                    el.classList.remove('active', 'completed');
                }
            });

            // Show new step
            currentOnboardingStep = step;
            const newStep = document.getElementById(`onboarding-step-${step}`);
            if (newStep) {
                newStep.classList.add('active');
            }

            // Handle step-specific initialization
            if (step === 2) {
                // Update quiz subject names
                if (onboardingData.subject) {
                    const subject1 = document.getElementById('quizSubject1');
                    const subject2 = document.getElementById('quizSubject2');
                    if (subject1) subject1.textContent = onboardingData.subject;
                    if (subject2) subject2.textContent = onboardingData.subject;
                }
                
                // Reset quiz to show first question
                const q1 = document.getElementById('quiz-q1');
                const q2 = document.getElementById('quiz-q2');
                const q3 = document.getElementById('quiz-q3');
                if (q1) q1.style.display = 'block';
                if (q2) q2.style.display = 'none';
                if (q3) q3.style.display = 'none';
                
                // Disable next button until all questions answered
                const step2Btn = document.getElementById('step2NextBtn');
                if (step2Btn && !onboardingData.q3) {
                    step2Btn.disabled = true;
                }
            }

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        window.selectQuizOption = function(questionNum, answer, element) {
            // Remove selection from all options in this question
            const parent = element.closest('.quiz-section');
            parent.querySelectorAll('.quiz-option').forEach(opt => {
                opt.classList.remove('selected');
            });

            // Add selection to clicked option
            element.classList.add('selected');

            // Store answer
            onboardingData[`q${questionNum}`] = answer;

            // Move to next question or enable button
            setTimeout(() => {
                if (questionNum === 1) {
                    document.getElementById('quiz-q1').style.display = 'none';
                    document.getElementById('quiz-q2').style.display = 'block';
                } else if (questionNum === 2) {
                    document.getElementById('quiz-q2').style.display = 'none';
                    document.getElementById('quiz-q3').style.display = 'block';
                } else if (questionNum === 3) {
                    document.getElementById('step2NextBtn').disabled = false;
                }
            }, 300);
        }

        window.analyzeAndShowLevel = function() {
            // Show loading
            const loadingDiv = document.getElementById('advanced-loading');
            if (loadingDiv) {
                loadingDiv.style.display = 'block';
            }

            // Simulate AI analysis
            setTimeout(() => {
                // Determine level based on answers
                let level = 'beginner';
                let icon = '🌱';
                let levelText = 'BEGINNER';
                let description = 'Perfect for those starting fresh with fundamentals';

                if (onboardingData.q1 === 'somewhat' || onboardingData.q1 === 'well') {
                    if (onboardingData.q2 === 'confident' || onboardingData.q2 === 'very-confident') {
                        if (onboardingData.q3 === 'advanced' || onboardingData.q3 === 'expert') {
                            level = 'advanced';
                            icon = '🌳';
                            levelText = 'ADVANCED';
                            description = 'You\'re ready for complex topics and deep dives';
                        } else {
                            level = 'intermediate';
                            icon = '🌿';
                            levelText = 'INTERMEDIATE';
                            description = 'Build on your foundation with structured learning';
                        }
                    } else {
                        level = 'intermediate';
                        icon = '🌿';
                        levelText = 'INTERMEDIATE';
                        description = 'Strengthen your knowledge at a comfortable pace';
                    }
                }

                onboardingData.suggestedLevel = level;
                onboardingData.selectedLevel = level;

                // Update UI
                document.getElementById('suggestedLevelIcon').textContent = icon;
                document.getElementById('suggestedLevelText').textContent = levelText;
                document.getElementById('suggestedLevelDesc').textContent = description;

                // Hide loading
                if (loadingDiv) {
                    loadingDiv.style.display = 'none';
                }

                // Go to step 3
                goToOnboardingStep(3);
            }, 1500);
        }

        window.toggleManualLevel = function() {
            const section = document.getElementById('manualLevelSection');
            if (section) {
                section.style.display = section.style.display === 'none' ? 'block' : 'none';
            }
        };

        window.selectManualLevel = function(level, icon, levelText, description) {
            // Remove selection from all
            document.querySelectorAll('.level-choice-card').forEach(card => {
                card.classList.remove('selected');
            });

            // Add selection to clicked
            event.target.closest('.level-choice-card').classList.add('selected');

            // Update data
            onboardingData.selectedLevel = level;

            // Update display
            document.getElementById('suggestedLevelIcon').textContent = icon;
            document.getElementById('suggestedLevelText').textContent = levelText.toUpperCase();
            document.getElementById('suggestedLevelDesc').textContent = description;

            // Hide manual section after a moment
            setTimeout(() => {
                document.getElementById('manualLevelSection').style.display = 'none';
            }, 800);
        }

        window.continueWithFree = function() {
            // Save that user chose free plan
            localStorage.setItem('planType', 'free');
            
            // Generate the plan
            generateAdvancedPlanFromOnboarding();
        };

        window.showPremiumModal = function() {
            alert('Premium Plan - $4.99/month\n\n' +
                  '✅ Unlimited study plans\n' +
                  '✅ Advanced AI tutor mode\n' +
                  '✅ Unlimited resources\n' +
                  '✅ Progress analytics\n' +
                  '✅ AI motivation coach\n' +
                  '✅ Calendar integration\n' +
                  '✅ Priority support\n\n' +
                  'For this demo, all premium features are unlocked!\n\n' +
                  'Click OK to continue with premium features enabled.');
            
            // Save that user chose premium (for demo)
            localStorage.setItem('planType', 'premium');
            
            // Generate the plan
            generateAdvancedPlanFromOnboarding();
        };

        function generateAdvancedPlanFromOnboarding() {
            // Validate we have a subject
            if (!onboardingData.subject || onboardingData.subject.trim() === '') {
                alert('Please go back and enter a subject you want to learn!');
                return;
            }

            // Create a mock user assessment data object that matches what enhanced-app.js expects
            const mockAssessmentData = {
                subjectOfInterest: onboardingData.subject,
                dailyStudyHours: onboardingData.dailyHours,
                studyDuration: onboardingData.totalDays,
                knowledgeLevel: onboardingData.selectedLevel,
                learningStyle: 'mixed',
                currentMood: 'focused',
                educationLevel: 'university',
                studyPurpose: 'personal',
                specificGoals: `Master ${onboardingData.subject}`,
                preferredDifficulty: '3'
            };

            // Store in window for enhanced-app.js to access
            window.userAssessment = {
                getData: function() {
                    return mockAssessmentData;
                },
                saveCurrentStep: function() {
                    // No-op for onboarding flow
                }
            };

            // Hide onboarding
            document.getElementById('onboarding-assessment').style.display = 'none';

            // Call the existing generateAdvancedPlan function
            if (typeof generateAdvancedPlan === 'function') {
                generateAdvancedPlan();
            } else {
                // Fallback to demo
                generateAdvancedPlanDemo();
            }
        }

        function generateAdvancedPlanDemo() {
            const planData = {
                subject: onboardingData.subject,
                dailyHours: parseInt(onboardingData.dailyHours),
                totalDays: parseInt(onboardingData.totalDays),
                difficulty: onboardingData.selectedLevel
            };
            
            // Store current plan subject for localStorage keys
            localStorage.setItem('currentPlanSubject', planData.subject);

            // Show loading
            document.getElementById('advanced-loading').style.display = 'block';

            setTimeout(() => {
                document.getElementById('advanced-loading').style.display = 'none';
                displayDemoAdvancedResults(planData);
            }, 2000);
        }

        // Enhanced version of generateAdvancedPlan
        async function generateAdvancedPlanFromData(planData) {
            try {
                // Use the existing API call structure
                const response = await fetch('http://localhost:8000/advanced-plan', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        subject: planData.subject,
                        daily_hours: planData.dailyHours,
                        total_days: planData.totalDays,
                        difficulty: planData.difficulty,
                        learning_style: 'mixed',
                        current_knowledge: onboardingData.q1,
                        goals: onboardingData.q3
                    })
                });

                const data = await response.json();

                // Hide loading
                document.getElementById('advanced-loading').style.display = 'none';

                // Display results using existing function
                displayAdvancedResults(data);

            } catch (error) {
                console.error('Error:', error);
                document.getElementById('advanced-loading').style.display = 'none';
                
                // Show demo results
                displayDemoAdvancedResults(planData);
            }
        }

        function displayDemoAdvancedResults(planData) {
            const resultsDiv = document.getElementById('advanced-results');
            
            // Generate roadmap nodes with interactive progress
            let scheduleHtml = '';
            const daysToShow = Math.min(planData.totalDays, 7);
            const today = new Date();
            
            const topics = [
                { 
                    name: 'Introduction & Fundamentals', 
                    difficulty: 'easy', 
                    emoji: '📖',
                    activities: ['Reading', 'Video Lectures', 'Note-taking'],
                    resources: [
                        { title: `${planData.subject} Basics Course`, type: 'Course', duration: '2 hours', icon: '📘' },
                        { title: 'Beginner Tutorial', type: 'Video', duration: '30 mins', icon: '🎥' },
                        { title: 'Quick Start Guide', type: 'Article', duration: '15 mins', icon: '📄' }
                    ]
                },
                { 
                    name: 'Core Concepts', 
                    difficulty: 'easy', 
                    emoji: '⚡',
                    activities: ['Practice Exercises', 'Interactive Demos', 'Quizzes'],
                    resources: [
                        { title: 'Interactive Practice Platform', type: 'Course', duration: '3 hours', icon: '📘' },
                        { title: 'Concept Deep Dive', type: 'Video', duration: '45 mins', icon: '🎥' },
                        { title: 'Core Principles Guide', type: 'Article', duration: '20 mins', icon: '📄' }
                    ]
                },
                { 
                    name: 'Practical Applications', 
                    difficulty: 'medium', 
                    emoji: '🛠️',
                    activities: ['Hands-on Projects', 'Code Labs', 'Case Studies'],
                    resources: [
                        { title: 'Real-World Projects', type: 'Course', duration: '4 hours', icon: '📘' },
                        { title: 'Build With Me Tutorial', type: 'Video', duration: '1 hour', icon: '🎥' },
                        { title: 'Case Study Collection', type: 'Article', duration: '30 mins', icon: '📄' }
                    ]
                },
                { 
                    name: 'Advanced Techniques', 
                    difficulty: 'medium', 
                    emoji: '🚀',
                    activities: ['Problem Solving', 'Research Papers', 'Deep Dive'],
                    resources: [
                        { title: 'Advanced Masterclass', type: 'Course', duration: '5 hours', icon: '📘' },
                        { title: 'Expert Techniques', type: 'Video', duration: '1.5 hours', icon: '🎥' },
                        { title: 'Research Papers Summary', type: 'Article', duration: '40 mins', icon: '📄' }
                    ]
                },
                { 
                    name: 'Real-World Projects', 
                    difficulty: 'hard', 
                    emoji: '🏗️',
                    activities: ['Build Projects', 'Peer Review', 'Portfolio Work'],
                    resources: [
                        { title: 'Portfolio Projects Guide', type: 'Course', duration: '6 hours', icon: '📘' },
                        { title: 'Project Walkthrough', type: 'Video', duration: '2 hours', icon: '🎥' },
                        { title: 'Best Practices', type: 'Article', duration: '25 mins', icon: '📄' }
                    ]
                },
                { 
                    name: 'Optimization & Best Practices', 
                    difficulty: 'hard', 
                    emoji: '⚙️',
                    activities: ['Code Review', 'Performance Tuning', 'Testing'],
                    resources: [
                        { title: 'Optimization Techniques', type: 'Course', duration: '4 hours', icon: '📘' },
                        { title: 'Performance Tuning Tips', type: 'Video', duration: '1 hour', icon: '🎥' },
                        { title: 'Testing Strategies', type: 'Article', duration: '30 mins', icon: '📄' }
                    ]
                },
                { 
                    name: 'Mastery & Assessment', 
                    difficulty: 'medium', 
                    emoji: '🎓',
                    activities: ['Final Project', 'Comprehensive Test', 'Self-Assessment'],
                    resources: [
                        { title: 'Final Exam Prep', type: 'Course', duration: '3 hours', icon: '📘' },
                        { title: 'Certification Guide', type: 'Video', duration: '45 mins', icon: '🎥' },
                        { title: 'Assessment Checklist', type: 'Article', duration: '20 mins', icon: '📄' }
                    ]
                }
            ];

            // Load completed days from localStorage
            const currentPlanSubject = localStorage.getItem('currentPlanSubject') || planData.subject;
            const storageKey = `completedDays_${currentPlanSubject}`;
            const completedDays = JSON.parse(localStorage.getItem(storageKey) || '[]');
            console.log('📊 Loaded completed days:', completedDays);

            for (let i = 0; i < daysToShow; i++) {
                const dayDate = new Date(today);
                dayDate.setDate(today.getDate() + i);
                const formattedDate = dayDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
                
                const topic = topics[i] || topics[topics.length - 1];
                const dayNumber = i + 1;
                
                // Check if this day is completed
                const isCompleted = completedDays.includes(dayNumber);
                const status = isCompleted ? 'completed' : (i === 0 ? 'in-progress' : 'not-started');
                const progress = isCompleted ? 100 : (i === 0 ? 25 : 0);
                const checkboxChecked = isCompleted ? 'checked' : '';
                
                const difficultyClass = `difficulty-${topic.difficulty}`;
                const difficultyIcon = topic.difficulty === 'easy' ? '🟢' : topic.difficulty === 'medium' ? '🟡' : '🔴';
                
                const markerIcon = status === 'completed' ? '✓' : topic.emoji;
                const resourcesJson = JSON.stringify(topic.resources);
                
                scheduleHtml += `
                    <div class="roadmap-node ${status}" data-day="${i + 1}" data-emoji="${topic.emoji}" data-topic="${topic.name}" data-resources='${resourcesJson}'>
                        <div class="roadmap-marker">
                            ${markerIcon}
                        </div>
                        <div class="roadmap-card">
                            <div class="timeline-header">
                                <div class="timeline-day-info">
                                    <h4>Day ${i + 1}: ${topic.name}</h4>
                                    <span class="timeline-date">${formattedDate}</span>
                                </div>
                                <div class="timeline-status">
                                    <input type="checkbox" 
                                           class="timeline-checkbox" 
                                           ${checkboxChecked}
                                           onclick="event.stopPropagation()"
                                           onchange="toggleDayCompletion(${i + 1}, this.checked)"
                                           title="Mark as complete">
                                    <span class="status-badge ${status}">
                                        ${status === 'completed' ? '✓ Done' : status === 'in-progress' ? '⏳ In Progress' : '⭕ Pending'}
                                    </span>
                                </div>
                            </div>

                            <div class="timeline-topics">
                                <h5>📚 Today's Focus</h5>
                                <div class="topic-list">
                                    ${topic.activities.map(activity => `<span class="topic-tag">• ${activity}</span>`).join('')}
                                </div>
                            </div>

                            <div class="timeline-footer">
                                <div class="timeline-duration">
                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/>
                                        <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z"/>
                                    </svg>
                                    ${planData.dailyHours} hours
                                </div>
                                <span class="difficulty-indicator ${difficultyClass}">
                                    ${difficultyIcon} ${topic.difficulty.charAt(0).toUpperCase() + topic.difficulty.slice(1)}
                                </span>
                                <div class="timeline-progress">
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: ${progress}%"></div>
                                    </div>
                                    <span class="progress-text">${progress}%</span>
                                </div>
                            </div>
                            <div class="resource-view-prompt">
                                <button class="view-resources-btn" onclick="openResourcePopup(${i + 1}, '${topic.name}', ${JSON.stringify(topic.resources).replace(/'/g, "&#39;")})">
                                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16" style="margin-right: 0.25rem;">
                                        <path d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"/>
                                    </svg>
                                    View ${topic.resources.length} Resources
                                </button>
                            </div>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // Build the complete results HTML with roadmap
            resultsDiv.innerHTML = `
                <div class="results">
                    <div class="results-header">
                        <h3>Your Personalized ${planData.subject} Study Plan</h3>
                        <button class="new-plan-btn" onclick="startNewPlan()" title="Create a new study plan">
                            <svg width="18" height="18" fill="currentColor" viewBox="0 0 16 16" style="margin-right: 0.5rem;">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                            </svg>
                            Start New Plan
                        </button>
                    </div>
                    <div class="results-content">
                        <div class="plan-overview">
                            <div class="plan-stat">
                                <div class="plan-stat-label">Subject</div>
                                <div class="plan-stat-value">${planData.subject}</div>
                            </div>
                            <div class="plan-stat">
                                <div class="plan-stat-label">Difficulty Level</div>
                                <div class="plan-stat-value">${planData.difficulty}</div>
                            </div>
                            <div class="plan-stat">
                                <div class="plan-stat-label">Study Duration</div>
                                <div class="plan-stat-value">${planData.totalDays} Days</div>
                            </div>
                            <div class="plan-stat">
                                <div class="plan-stat-label">Daily Commitment</div>
                                <div class="plan-stat-value">${planData.dailyHours} Hours</div>
                            </div>
                        </div>
                        
                        <div class="schedule-roadmap-container">
                            <div class="schedule-roadmap">
                                <div class="roadmap-path"></div>
                                ${scheduleHtml}
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Attach event listeners to roadmap nodes after rendering
            setTimeout(() => {
                console.log('🎯 Attaching roadmap event listeners...');
                attachRoadmapEventListeners();
            }, 100);
        }

        // Attach click listeners to roadmap nodes
        function attachRoadmapEventListeners() {
            const roadmapNodes = document.querySelectorAll('.roadmap-node');
            console.log(`✅ Found ${roadmapNodes.length} roadmap nodes to attach listeners`);
            roadmapNodes.forEach(node => {
                const marker = node.querySelector('.roadmap-marker');
                const card = node.querySelector('.roadmap-card');
                const dayNumber = parseInt(node.getAttribute('data-day'));
                const topicName = node.getAttribute('data-topic');
                const resourcesJson = node.getAttribute('data-resources');
                
                if (marker && card && resourcesJson) {
                    const resources = JSON.parse(resourcesJson);
                    
                    // Add click handlers
                    const clickHandler = (e) => {
                        // Don't trigger if clicking checkbox
                        if (!e.target.classList.contains('timeline-checkbox')) {
                            openResourcePopup(dayNumber, topicName, resources);
                        }
                    };
                    
                    marker.addEventListener('click', clickHandler);
                    card.addEventListener('click', clickHandler);
                    
                    // Add hover effect
                    marker.style.cursor = 'pointer';
                    card.style.cursor = 'pointer';
                }
            });
        }

        // Toggle day completion status with localStorage persistence
        function toggleDayCompletion(dayNumber, isCompleted) {
            const roadmapNode = document.querySelector(`[data-day="${dayNumber}"]`);
            if (!roadmapNode) return;

            const marker = roadmapNode.querySelector('.roadmap-marker');
            const statusBadge = roadmapNode.querySelector('.status-badge');
            const progressFill = roadmapNode.querySelector('.progress-fill');
            const progressText = roadmapNode.querySelector('.progress-text');
            const checkbox = roadmapNode.querySelector('.timeline-checkbox');

            // Get current plan ID for localStorage key
            const currentPlanSubject = localStorage.getItem('currentPlanSubject') || 'default';
            const storageKey = `completedDays_${currentPlanSubject}`;
            const completedDays = JSON.parse(localStorage.getItem(storageKey) || '[]');

            if (isCompleted) {
                roadmapNode.classList.remove('in-progress', 'not-started');
                roadmapNode.classList.add('completed');
                marker.textContent = '✓';
                statusBadge.className = 'status-badge completed';
                statusBadge.textContent = '✓ Done';
                progressFill.style.width = '100%';
                progressText.textContent = '100%';
                if (checkbox) checkbox.checked = true;

                // Celebrate with a subtle animation
                roadmapNode.style.animation = 'none';
                setTimeout(() => {
                    roadmapNode.style.animation = 'pulse 1.5s ease-in-out infinite';
                }, 10);
                
                // Animate roadmap path progress
                animateRoadmapPath(dayNumber);
                
                // Move in-progress to next day
                moveToNextDay(dayNumber);
                
                // Save to localStorage
                if (!completedDays.includes(dayNumber)) {
                    completedDays.push(dayNumber);
                }
                
            } else {
                roadmapNode.classList.remove('completed');
                roadmapNode.classList.add('not-started');
                // Get the original emoji from the data attribute or set to day number
                const originalEmoji = roadmapNode.getAttribute('data-emoji') || dayNumber;
                marker.textContent = originalEmoji;
                statusBadge.className = 'status-badge not-started';
                statusBadge.textContent = '⭕ Pending';
                progressFill.style.width = '0%';
                progressText.textContent = '0%';
                if (checkbox) checkbox.checked = false;
                
                // Update roadmap path
                animateRoadmapPath(dayNumber - 1);
                
                // Remove from localStorage
                const index = completedDays.indexOf(dayNumber);
                if (index > -1) completedDays.splice(index, 1);
            }

            // Persist to localStorage
            localStorage.setItem(storageKey, JSON.stringify(completedDays));
            console.log(`✅ Day ${dayNumber} completion status saved:`, isCompleted);
        }
        
        // Animate roadmap path fill
        function animateRoadmapPath(completedUpToDay) {
            const roadmapPath = document.querySelector('.roadmap-path');
            if (!roadmapPath) return;
            
            const allNodes = document.querySelectorAll('.roadmap-node');
            const totalNodes = allNodes.length;
            
            if (totalNodes === 0) return;
            
            // Calculate percentage: each node represents a segment
            const percentComplete = (completedUpToDay / totalNodes) * 100;
            
            // Create animated gradient that fills up
            roadmapPath.style.background = `linear-gradient(
                to bottom,
                #10b981 0%,
                #10b981 ${percentComplete}%,
                rgba(59, 130, 246, 0.3) ${percentComplete}%,
                rgba(236, 72, 153, 0.3) 100%
            )`;
            
            // Add glow effect at the current position
            roadmapPath.style.filter = 'drop-shadow(0 0 8px rgba(16, 185, 129, 0.6))';
            roadmapPath.style.transition = 'all 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
        }
        
        // Move in-progress status to next day
        function moveToNextDay(currentDay) {
            const allNodes = document.querySelectorAll('.roadmap-node');
            const nextDayNode = document.querySelector(`[data-day="${currentDay + 1}"]`);
            
            if (nextDayNode && nextDayNode.classList.contains('not-started')) {
                // Remove in-progress from all nodes first
                allNodes.forEach(node => {
                    if (node.classList.contains('in-progress')) {
                        node.classList.remove('in-progress');
                        node.classList.add('not-started');
                        const badge = node.querySelector('.status-badge');
                        if (badge) {
                            badge.className = 'status-badge not-started';
                            badge.textContent = '⭕ Pending';
                        }
                    }
                });
                
                // Set next day as in-progress
                nextDayNode.classList.remove('not-started');
                nextDayNode.classList.add('in-progress');
                const nextBadge = nextDayNode.querySelector('.status-badge');
                if (nextBadge) {
                    nextBadge.className = 'status-badge in-progress';
                    nextBadge.textContent = '⏳ In Progress';
                }
                
                // Update progress for next day
                const nextProgress = nextDayNode.querySelector('.progress-fill');
                const nextProgressText = nextDayNode.querySelector('.progress-text');
                if (nextProgress && nextProgressText) {
                    nextProgress.style.width = '25%';
                    nextProgressText.textContent = '25%';
                }
                
                // Scroll to next day smoothly
                nextDayNode.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        // ===== ROADMAP RESOURCE POPUP FUNCTIONS =====
        
        function openResourcePopup(dayNumber, topicName, resources) {
            // Create overlay
            const overlay = document.createElement('div');
            overlay.className = 'resource-popup-overlay';
            overlay.onclick = closeResourcePopup;
            
            // Create flashcard
            const flashcard = document.createElement('div');
            flashcard.className = 'resource-flashcard';
            flashcard.onclick = (e) => e.stopPropagation(); // Prevent closing when clicking inside
            
            // Generate resource items HTML
            const resourceItemsHtml = resources.map((resource, index) => `
                <div class="resource-item-flashcard" style="animation-delay: ${0.1 + index * 0.1}s">
                    <div class="resource-flashcard-icon">${resource.icon}</div>
                    <div class="resource-flashcard-content">
                        <h4>${resource.title}</h4>
                        <div style="display: flex; gap: 1rem; align-items: center; margin-top: 0.5rem;">
                            <span class="resource-type-badge">${resource.type}</span>
                            <span style="color: #6b7280; font-size: 0.875rem;">⏱️ ${resource.duration}</span>
                        </div>
                    </div>
                    <button class="resource-action-btn" onclick="window.open('https://www.youtube.com/results?search_query=${encodeURIComponent(resource.title)}', '_blank')">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16" style="margin-right: 0.5rem;">
                            <path d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"/>
                            <path d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"/>
                        </svg>
                        View Resource
                    </button>
                </div>
            `).join('');
            
            flashcard.innerHTML = `
                <div class="flashcard-header">
                    <div>
                        <h3 style="margin: 0; font-size: 1.5rem; font-weight: 700;">📚 Day ${dayNumber} Resources</h3>
                        <p style="margin: 0.5rem 0 0 0; opacity: 0.9; font-size: 1rem;">${topicName}</p>
                    </div>
                    <button class="flashcard-close" onclick="closeResourcePopup()">
                        <svg width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
                        </svg>
                    </button>
                </div>
                <div class="flashcard-body">
                    <p style="color: #6b7280; margin-bottom: 1.5rem; font-size: 1rem;">
                        🎯 Recommended resources to help you master this topic. Click "View Resource" to explore!
                    </p>
                    <div class="flashcard-resources-list">
                        ${resourceItemsHtml}
                    </div>
                    <div style="text-align: center; margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid #e5e7eb;">
                        <p style="color: #9ca3af; font-size: 0.875rem; margin: 0;">
                            💡 Tip: Complete these resources in order for the best learning experience
                        </p>
                    </div>
                </div>
            `;
            
            overlay.appendChild(flashcard);
            document.body.appendChild(overlay);
            
            // Trigger animation
            setTimeout(() => {
                overlay.style.opacity = '1';
                flashcard.style.animation = 'slideUpBounce 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards';
            }, 10);
        }
        
        function closeResourcePopup() {
            const overlay = document.querySelector('.resource-popup-overlay');
            if (overlay) {
                overlay.style.opacity = '0';
                setTimeout(() => {
                    overlay.remove();
                }, 300);
            }
        }

        // ===== NEW PLAN FUNCTION =====
        
        window.startNewPlan = function() {
            if (confirm('Are you sure you want to create a new study plan? This will reset your current plan.')) {
                // Clear the current plan from localStorage
                const currentPlanSubject = localStorage.getItem('currentPlanSubject');
                if (currentPlanSubject) {
                    localStorage.removeItem(`completedDays_${currentPlanSubject}`);
                }
                
                // Hide results and show the form again
                document.getElementById('advanced-results').classList.add('hidden');
                document.querySelector('.onboarding-wizard').classList.remove('hidden');
                
                // Reset to first step
                window.currentOnboardingStep = 1;
                showOnboardingStep(1);
                
                // Clear stored onboarding data
                localStorage.removeItem('onboardingData');
                localStorage.removeItem('currentPlanSubject');
                
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                console.log('✅ Ready for new plan creation');
            }
        }

        // ===== RESOURCE HUB FUNCTIONS =====

        function generateResourceCards(subject) {
            const resources = [
                {
                    type: 'course',
                    title: `Complete ${subject} Masterclass 2024`,
                    description: 'Comprehensive course covering all fundamentals to advanced concepts with hands-on projects',
                    rating: 4.8,
                    reviews: 12543,
                    duration: '24 hours',
                    url: `https://www.coursera.org/search?query=${encodeURIComponent(subject)}`,
                    premium: false
                },
                {
                    type: 'video',
                    title: `${subject} Crash Course for Beginners`,
                    description: 'Fast-paced introduction to key concepts with practical examples and exercises',
                    rating: 4.6,
                    reviews: 8921,
                    duration: '2.5 hours',
                    url: `https://www.youtube.com/results?search_query=${encodeURIComponent(subject)}+tutorial`,
                    premium: false
                },
                {
                    type: 'article',
                    title: `${subject} Best Practices & Patterns`,
                    description: 'In-depth article series exploring modern techniques and industry standards',
                    rating: 4.7,
                    reviews: 3456,
                    duration: '45 min read',
                    url: `https://medium.com/search?q=${encodeURIComponent(subject)}`,
                    premium: false
                },
                {
                    type: 'book',
                    title: `The Definitive ${subject} Guide`,
                    description: 'Authoritative textbook used by top universities and professionals worldwide',
                    rating: 4.9,
                    reviews: 15678,
                    duration: '450 pages',
                    url: `https://www.amazon.com/s?k=${encodeURIComponent(subject)}+book`,
                    premium: true
                },
                {
                    type: 'course',
                    title: `Advanced ${subject} Techniques`,
                    description: 'Expert-level course with real-world projects and industry case studies',
                    rating: 4.8,
                    reviews: 6789,
                    duration: '18 hours',
                    url: `https://www.udemy.com/courses/search/?q=${encodeURIComponent(subject)}`,
                    premium: true
                },
                {
                    type: 'video',
                    title: `${subject} Project-Based Learning`,
                    description: 'Build 10 real-world projects while learning core concepts step-by-step',
                    rating: 4.7,
                    reviews: 9834,
                    duration: '8 hours',
                    url: `https://www.youtube.com/results?search_query=${encodeURIComponent(subject)}+projects`,
                    premium: false
                }
            ];

            return resources.map((resource, index) => {
                const stars = '★'.repeat(Math.floor(resource.rating)) + (resource.rating % 1 >= 0.5 ? '☆' : '');
                const iconMap = { video: '🎥', course: '📘', article: '📄', book: '📚' };
                
                return `
                    <div class="resource-card-modern" data-type="${resource.type}" data-rating="${resource.rating}" data-title="${resource.title.toLowerCase()}" data-index="${index}">
                        ${resource.premium ? '<div class="premium-lock">🔒 Premium</div>' : ''}
                        <div class="resource-thumbnail ${resource.type}">
                            ${iconMap[resource.type]}
                        </div>
                        <div class="resource-card-body">
                            <div class="resource-card-header">
                                <span class="resource-type-badge ${resource.type}">${resource.type}</span>
                                <button class="resource-favorite" onclick="toggleFavorite(${index}, this)">
                                    ♡
                                </button>
                            </div>
                            <h5 class="resource-card-title">${resource.title}</h5>
                            <p class="resource-card-description">${resource.description}</p>
                            <div class="resource-rating">
                                <div class="stars">${stars}</div>
                                <span class="rating-count">${resource.rating} (${resource.reviews.toLocaleString()})</span>
                            </div>
                            <div class="resource-card-footer">
                                <span class="resource-duration">
                                    <svg width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/>
                                        <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z"/>
                                    </svg>
                                    ${resource.duration}
                                </span>
                                <button class="resource-view-btn" onclick="window.open('${resource.url}', '_blank')">
                                    View
                                    <svg width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"/>
                                        <path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function filterByType(type) {
            // Update active button
            document.querySelectorAll('.filter-btn[data-type]').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.type === type);
            });

            // Filter cards
            const cards = document.querySelectorAll('.resource-card-modern');
            let visibleCount = 0;

            cards.forEach(card => {
                const cardType = card.dataset.type;
                const shouldShow = type === 'all' || cardType === type;
                card.style.display = shouldShow ? 'block' : 'none';
                if (shouldShow) visibleCount++;
            });

            // Show/hide no results message
            document.getElementById('noResourcesMessage').style.display = visibleCount === 0 ? 'block' : 'none';
        }

        function filterResources() {
            const searchTerm = document.getElementById('resourceSearch').value.toLowerCase();
            const cards = document.querySelectorAll('.resource-card-modern');
            let visibleCount = 0;

            cards.forEach(card => {
                const title = card.dataset.title;
                const shouldShow = title.includes(searchTerm);
                card.style.display = shouldShow ? 'block' : 'none';
                if (shouldShow) visibleCount++;
            });

            document.getElementById('noResourcesMessage').style.display = visibleCount === 0 ? 'block' : 'none';
        }

        function sortResources(sortBy) {
            // Update active button (simplified - could enhance)
            const grid = document.getElementById('resourcesGrid');
            const cards = Array.from(document.querySelectorAll('.resource-card-modern'));

            cards.sort((a, b) => {
                if (sortBy === 'rating') {
                    return parseFloat(b.dataset.rating) - parseFloat(a.dataset.rating);
                } else if (sortBy === 'duration') {
                    // Simple duration sort (would need parsing in real app)
                    return parseInt(a.querySelector('.resource-duration').textContent) - 
                           parseInt(b.querySelector('.resource-duration').textContent);
                } else if (sortBy === 'newest') {
                    return parseInt(b.dataset.index) - parseInt(a.dataset.index);
                }
            });

            // Re-append in sorted order
            cards.forEach(card => grid.appendChild(card));
        }

        function toggleFavorite(resourceIndex, button) {
            const favorites = JSON.parse(localStorage.getItem('favoriteResources') || '[]');
            
            if (button.classList.contains('active')) {
                button.classList.remove('active');
                button.textContent = '♡';
                const index = favorites.indexOf(resourceIndex);
                if (index > -1) favorites.splice(index, 1);
            } else {
                button.classList.add('active');
                button.textContent = '♥';
                if (!favorites.includes(resourceIndex)) {
                    favorites.push(resourceIndex);
                }
            }

            localStorage.setItem('favoriteResources', JSON.stringify(favorites));
            
            // Show toast notification
            if (button.classList.contains('active')) {
                showToast('success', 'Saved!', 'Resource added to favorites');
            } else {
                showToast('info', 'Removed', 'Resource removed from favorites');
            }
        }

        // ===== TOAST NOTIFICATION SYSTEM =====

        function showToast(type = 'success', title = '', message = '') {
            // Create toast container if it doesn't exist
            let toastContainer = document.querySelector('.toast-container');
            if (!toastContainer) {
                toastContainer = document.createElement('div');
                toastContainer.className = 'toast-container';
                document.body.appendChild(toastContainer);
            }

            // Icon mapping
            const icons = {
                success: '✓',
                error: '✕',
                warning: '⚠',
                info: 'ℹ'
            };

            // Create toast element
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <span class="toast-icon">${icons[type]}</span>
                <div class="toast-content">
                    <p class="toast-title">${title}</p>
                    <p class="toast-message">${message}</p>
                </div>
                <button class="toast-close" onclick="this.parentElement.remove()">×</button>
            `;

            // Add to container
            toastContainer.appendChild(toast);

            // Auto-remove after 4 seconds
            setTimeout(() => {
                toast.style.animation = 'slideOutRight 0.3s ease-out';
                setTimeout(() => toast.remove(), 300);
            }, 4000);
        }

        // ===== CONFETTI CELEBRATION =====

        function triggerConfetti() {
            const container = document.createElement('div');
            container.className = 'confetti-container';
            document.body.appendChild(container);

            const colors = ['#f59e0b', '#10b981', '#3b82f6', '#8b5cf6', '#ef4444', '#ec4899'];
            const confettiCount = 50;

            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 0.5 + 's';
                confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                
                // Random shapes
                if (Math.random() > 0.5) {
                    confetti.style.borderRadius = '50%';
                }
                
                container.appendChild(confetti);
            }

            // Remove after animation
            setTimeout(() => container.remove(), 5000);
        }

        // ===== LOADING OVERLAY =====

        function showLoading(text = 'Loading...') {
            let overlay = document.querySelector('.loading-overlay');
            if (!overlay) {
                overlay = document.createElement('div');
                overlay.className = 'loading-overlay';
                overlay.innerHTML = `
                    <div class="spinner-modern"></div>
                    <p class="loading-text">${text}</p>
                `;
                document.body.appendChild(overlay);
            }
            overlay.classList.remove('hidden');
        }

        function hideLoading() {
            const overlay = document.querySelector('.loading-overlay');
            if (overlay) {
                overlay.classList.add('hidden');
            }
        }

        // ===== SKELETON LOADERS =====

        function showSkeletonLoaders(containerId, count = 3) {
            const container = document.getElementById(containerId);
            if (!container) return;

            let skeletonHTML = '';
            for (let i = 0; i < count; i++) {
                skeletonHTML += `
                    <div class="skeleton-card">
                        <div class="skeleton-header">
                            <div class="skeleton skeleton-title"></div>
                            <div class="skeleton skeleton-badge"></div>
                        </div>
                        <div class="skeleton skeleton-text"></div>
                        <div class="skeleton skeleton-text"></div>
                        <div class="skeleton skeleton-text short"></div>
                        <div class="skeleton skeleton-button"></div>
                    </div>
                `;
            }
            container.innerHTML = skeletonHTML;
        }

        // Enhanced toggleDayCompletion with celebration
        const originalToggleDayCompletion = toggleDayCompletion;
        function toggleDayCompletion(dayNumber, isCompleted) {
            const timelineItem = document.querySelector(`[data-day="${dayNumber}"]`);
            if (!timelineItem) return;

            const marker = timelineItem.querySelector('.timeline-marker');
            const statusBadge = timelineItem.querySelector('.status-badge');
            const progressFill = timelineItem.querySelector('.progress-fill');
            const progressText = timelineItem.querySelector('.progress-text');

            if (isCompleted) {
                timelineItem.classList.remove('in-progress', 'not-started');
                timelineItem.classList.add('completed');
                marker.textContent = '✓';
                statusBadge.className = 'status-badge completed';
                statusBadge.textContent = '✓ Done';
                progressFill.style.width = '100%';
                progressText.textContent = '100%';

                // Celebrate with animation and confetti
                timelineItem.style.animation = 'none';
                setTimeout(() => {
                    timelineItem.style.animation = 'celebration 0.6s ease';
                }, 10);

                // Show success toast
                showToast('success', 'Well Done! 🎉', `Day ${dayNumber} completed successfully!`);

                // Trigger confetti for milestones
                if (dayNumber % 3 === 0) {
                    triggerConfetti();
                }
            } else {
                timelineItem.classList.remove('completed');
                timelineItem.classList.add('not-started');
                marker.textContent = dayNumber;
                statusBadge.className = 'status-badge not-started';
                statusBadge.textContent = '⭕ Pending';
                progressFill.style.width = '0%';
                progressText.textContent = '0%';
                
                showToast('info', 'Unmarked', `Day ${dayNumber} set back to pending`);
            }

            // Save to localStorage
            const completedDays = JSON.parse(localStorage.getItem('completedDays') || '[]');
            if (isCompleted && !completedDays.includes(dayNumber)) {
                completedDays.push(dayNumber);
            } else if (!isCompleted) {
                const index = completedDays.indexOf(dayNumber);
                if (index > -1) completedDays.splice(index, 1);
            }
            localStorage.setItem('completedDays', JSON.stringify(completedDays));
        }

        // ===== DARK MODE FUNCTIONALITY =====

        function toggleDarkMode() {
            const body = document.body;
            const icon = document.getElementById('darkModeIcon');
            
            body.classList.toggle('dark-mode');
            
            // Update icon
            if (body.classList.contains('dark-mode')) {
                icon.textContent = '☀️';
                localStorage.setItem('darkMode', 'enabled');
                showToast('success', 'Dark Mode Enabled', 'Easy on the eyes! ✨');
            } else {
                icon.textContent = '🌙';
                localStorage.setItem('darkMode', 'disabled');
                showToast('info', 'Light Mode Enabled', 'Bright and clear! 💡');
            }
        }

        // Initialize dark mode from localStorage
        function initDarkMode() {
            const darkMode = localStorage.getItem('darkMode');
            const icon = document.getElementById('darkModeIcon');
            
            if (darkMode === 'enabled') {
                document.body.classList.add('dark-mode');
                if (icon) icon.textContent = '☀️';
            }
        }

        // Call on page load
        document.addEventListener('DOMContentLoaded', initDarkMode);

        // ===== HELP MODAL =====

        function toggleHelpModal() {
            const modal = document.getElementById('helpModal');
            modal.classList.toggle('active');
        }

        // ===== KEYBOARD SHORTCUTS =====

        document.addEventListener('keydown', function(e) {
            // ?: Show Help Modal
            if (e.key === '?' && !e.ctrlKey && !e.metaKey && document.activeElement.tagName !== 'INPUT') {
                e.preventDefault();
                toggleHelpModal();
            }

            // Ctrl/Cmd + D: Toggle Dark Mode
            if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
                e.preventDefault();
                toggleDarkMode();
            }

            // Ctrl/Cmd + S: Open Sidebar
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                toggleSidebar();
            }

            // Ctrl/Cmd + K: Focus Search (if on resources page)
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                const searchBar = document.getElementById('resourceSearch');
                if (searchBar) {
                    searchBar.focus();
                    showToast('info', 'Search Active', 'Start typing to filter resources');
                }
            }

            // Escape: Close modals/sidebar
            if (e.key === 'Escape') {
                const helpModal = document.getElementById('helpModal');
                if (helpModal && helpModal.classList.contains('active')) {
                    toggleHelpModal();
                    return;
                }

                const sidebar = document.getElementById('studyPlansSidebar');
                if (sidebar && sidebar.classList.contains('open')) {
                    toggleSidebar();
                }
            }
        });

        // ===== ERROR HANDLING =====

        window.addEventListener('error', function(e) {
            console.error('Global error:', e.error);
            // Only show toast for critical errors, not all errors
            // showToast('error', 'Oops!', 'Something went wrong. Please try again.');
        });

        // Removed unhandledrejection handler to prevent false connection error messages
        // window.addEventListener('unhandledrejection', function(e) {
        //     console.error('Unhandled promise rejection:', e.reason);
        //     showToast('error', 'Connection Issue', 'Please check your internet connection.');
        // });

        // Enhanced error handling for API calls
        function handleApiError(error, context = 'API call') {
            console.error(`Error in ${context}:`, error);
            
            if (error.message && error.message.includes('Failed to fetch')) {
                showToast('error', 'Network Error', 'Unable to connect. Please check your connection.');
            } else if (error.status === 401) {
                showToast('warning', 'Session Expired', 'Please log in again.');
            } else if (error.status === 429) {
                showToast('warning', 'Too Many Requests', 'Please wait a moment and try again.');
            } else {
                showToast('error', 'Error', error.message || 'An unexpected error occurred.');
            }
        }

        // ===== EMPTY STATE HANDLERS =====

        function showEmptyState(containerId, icon, title, message) {
            const container = document.getElementById(containerId);
            if (!container) return;

            container.innerHTML = `
                <div style="text-align: center; padding: 4rem 2rem; color: var(--text-secondary);">
                    <div style="font-size: 4rem; margin-bottom: 1rem;">${icon}</div>
                    <h3 style="color: var(--text-primary); margin-bottom: 0.5rem;">${title}</h3>
                    <p style="max-width: 400px; margin: 0 auto;">${message}</p>
                </div>
            `;
        }

        // ===== ACCESSIBILITY ENHANCEMENTS =====

        // Add focus visible styles programmatically
        const style = document.createElement('style');
        style.textContent = `
            *:focus-visible {
                outline: 2px solid #2563eb;
                outline-offset: 2px;
            }
            
            button:focus-visible,
            a:focus-visible {
                box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.3);
            }
        `;
        document.head.appendChild(style);

        // ===== PERFORMANCE MONITORING =====

        // Log page load time
        window.addEventListener('load', function() {
            if (window.performance && window.performance.timing) {
                const loadTime = window.performance.timing.loadEventEnd - window.performance.timing.navigationStart;
                console.log(`Page loaded in ${loadTime}ms`);
                
                if (loadTime > 3000) {
                    console.warn('Slow page load detected');
                }
            }
        });

        // ===== STUDY PLANS SIDEBAR FUNCTIONALITY =====

        function toggleSidebar() {
            const sidebar = document.getElementById('studyPlansSidebar');
            const overlay = document.getElementById('sidebarOverlay');
            const toggle = document.getElementById('sidebarToggle');

            const isOpen = sidebar.classList.contains('open');

            if (isOpen) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
                toggle.classList.remove('hidden');
            } else {
                sidebar.classList.add('open');
                overlay.classList.add('active');
                toggle.classList.add('hidden');
                loadSavedPlans();
            }
        }

        function saveStudyPlan(planData) {
            // Get existing plans
            let plans = JSON.parse(localStorage.getItem('studyPlans') || '[]');

            // Create plan object
            const plan = {
                id: Date.now(),
                subject: planData.subject,
                level: planData.difficulty || planData.selectedLevel || 'beginner',
                dailyHours: planData.dailyHours,
                totalDays: planData.totalDays,
                createdAt: new Date().toISOString(),
                planType: localStorage.getItem('planType') || 'free'
            };

            // Add to beginning of array (newest first)
            plans.unshift(plan);

            // Keep only last 10 plans
            if (plans.length > 10) {
                plans = plans.slice(0, 10);
            }

            // Save to localStorage
            localStorage.setItem('studyPlans', JSON.stringify(plans));

            // Update sidebar
            loadSavedPlans();
        }

        function loadSavedPlans() {
            const plans = JSON.parse(localStorage.getItem('studyPlans') || '[]');
            const container = document.getElementById('sidebarPlansContent');

            if (plans.length === 0) {
                container.innerHTML = `
                    <div class="no-plans">
                        <i class="fas fa-folder-open"></i>
                        <p>No study plans yet</p>
                        <small>Create your first plan to get started!</small>
                    </div>
                `;
                return;
            }

            let html = '';
            plans.forEach((plan, index) => {
                const date = new Date(plan.createdAt);
                const dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
                const timeStr = date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });

                const levelEmoji = {
                    'beginner': '🌱',
                    'intermediate': '🌿',
                    'advanced': '🌳',
                    'expert': '🏔️'
                };

                html += `
                    <div class="plan-card" onclick="loadPlan(${plan.id})">
                        <div class="plan-card-header">
                            <div class="plan-subject">${levelEmoji[plan.level] || '📚'} ${plan.subject}</div>
                            <div class="plan-level">${plan.level}</div>
                        </div>
                        <div class="plan-meta">
                            <span><i class="fas fa-clock"></i> ${plan.dailyHours}h/day</span>
                            <span><i class="fas fa-calendar"></i> ${plan.totalDays} days</span>
                            <span><i class="fas fa-${plan.planType === 'premium' ? 'crown' : 'gift'}"></i> ${plan.planType}</span>
                        </div>
                        <div class="plan-date">
                            <i class="fas fa-calendar-check"></i> ${dateStr} at ${timeStr}
                        </div>
                        <div class="plan-actions">
                            <button class="plan-action-btn load-btn" onclick="event.stopPropagation(); loadPlan(${plan.id})">
                                <i class="fas fa-play"></i> Load
                            </button>
                            <button class="plan-action-btn delete-btn" onclick="event.stopPropagation(); deletePlan(${plan.id})">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function loadPlan(planId) {
            const plans = JSON.parse(localStorage.getItem('studyPlans') || '[]');
            const plan = plans.find(p => p.id === planId);

            if (!plan) {
                alert('Plan not found!');
                return;
            }

            // Close sidebar
            toggleSidebar();

            // Populate onboarding form with saved data
            const subjectInput = document.getElementById('onboardingSubject');
            const dailyHoursSelect = document.getElementById('onboardingDailyHours');
            const totalDaysSelect = document.getElementById('onboardingTotalDays');

            if (subjectInput) subjectInput.value = plan.subject;
            if (dailyHoursSelect) dailyHoursSelect.value = plan.dailyHours;
            
            // Handle custom duration
            if (totalDaysSelect) {
                const standardDurations = ['7', '14', '30', '60'];
                if (standardDurations.includes(plan.totalDays.toString())) {
                    totalDaysSelect.value = plan.totalDays;
                } else {
                    totalDaysSelect.value = 'custom';
                    const customInput = document.getElementById('customDaysOnboarding');
                    if (customInput) {
                        customInput.value = plan.totalDays;
                        customInput.style.display = 'block';
                    }
                }
            }

            // Update onboarding data
            onboardingData.subject = plan.subject;
            onboardingData.dailyHours = plan.dailyHours.toString();
            onboardingData.totalDays = plan.totalDays.toString();
            onboardingData.selectedLevel = plan.level;

            // Enable step 1 next button
            updateStep1Button();

            // Show notification
            alert(`📚 Loaded: ${plan.subject}\n\nLevel: ${plan.level}\n${plan.dailyHours}h/day for ${plan.totalDays} days\n\nClick "Continue" to proceed with this plan!`);

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function deletePlan(planId) {
            if (!confirm('Are you sure you want to delete this study plan?')) {
                return;
            }

            let plans = JSON.parse(localStorage.getItem('studyPlans') || '[]');
            plans = plans.filter(p => p.id !== planId);
            localStorage.setItem('studyPlans', JSON.stringify(plans));

            loadSavedPlans();
        }

        // Initialize sidebar on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedPlans();
        });

        // Modify the continue and premium functions to save the plan
        const originalContinueWithFree = window.continueWithFree;
        window.continueWithFree = function() {
            const planData = {
                subject: onboardingData.subject,
                dailyHours: parseInt(onboardingData.dailyHours),
                totalDays: parseInt(onboardingData.totalDays),
                difficulty: onboardingData.selectedLevel,
                selectedLevel: onboardingData.selectedLevel
            };
            saveStudyPlan(planData);
            originalContinueWithFree();
        };

        const originalShowPremiumModal = window.showPremiumModal;
        window.showPremiumModal = function() {
            const planData = {
                subject: onboardingData.subject,
                dailyHours: parseInt(onboardingData.dailyHours),
                totalDays: parseInt(onboardingData.totalDays),
                difficulty: onboardingData.selectedLevel,
                selectedLevel: onboardingData.selectedLevel
            };
            saveStudyPlan(planData);
            originalShowPremiumModal();
        };
    </script>

    <!-- Toast Container (dynamically populated) -->
    <div class="toast-container"></div>

    <!-- Dark Mode Toggle -->
    <button class="dark-mode-toggle" onclick="toggleDarkMode()" title="Toggle Dark Mode">
        <span id="darkModeIcon">🌙</span>
    </button>

    <!-- Help Button -->
    <button class="help-button" onclick="toggleHelpModal()" title="Keyboard Shortcuts (?)">
        ?
    </button>

    <!-- Help Modal -->
    <div class="help-modal" id="helpModal">
        <div class="help-modal-content">
            <div class="help-modal-header">
                <h3>⌨️ Keyboard Shortcuts</h3>
                <button class="help-modal-close" onclick="toggleHelpModal()">×</button>
            </div>

            <div class="shortcuts-section">
                <h4>General</h4>
                <div class="shortcut-item">
                    <div class="shortcut-keys">
                        <span class="key">Ctrl</span>
                        <span>+</span>
                        <span class="key">D</span>
                    </div>
                    <span class="shortcut-description">Toggle Dark Mode</span>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-keys">
                        <span class="key">Ctrl</span>
                        <span>+</span>
                        <span class="key">S</span>
                    </div>
                    <span class="shortcut-description">Open Sidebar</span>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-keys">
                        <span class="key">Ctrl</span>
                        <span>+</span>
                        <span class="key">K</span>
                    </div>
                    <span class="shortcut-description">Focus Search</span>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-keys">
                        <span class="key">Esc</span>
                    </div>
                    <span class="shortcut-description">Close Modals</span>
                </div>
                <div class="shortcut-item">
                    <div class="shortcut-keys">
                        <span class="key">?</span>
                    </div>
                    <span class="shortcut-description">Show This Help</span>
                </div>
            </div>

            <div class="shortcuts-section">
                <h4>💡 Pro Tips</h4>
                <div style="color: var(--text-secondary); font-size: 0.875rem; line-height: 1.6;">
                    <p>• Click the flame icon 🔥 to see your study streak</p>
                    <p>• Mark days complete to unlock achievements</p>
                    <p>• Filter resources by type for focused learning</p>
                    <p>• Use dark mode for comfortable night studying</p>
                    <p>• Save your favorite resources with the ♥ button</p>
                </div>
            </div>
        </div>
    </div>

    <!-- User Assessment JavaScript -->
    <script src="user-assessment.js"></script>
    <script src="enhanced-app.js"></script>
</body>
</html>
